<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>Christopher Loan's Website: APA 2021 Supplemental Material</title>

<meta property="description" itemprop="description" content="Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, &amp; Keith Zvoch"/>

<link rel="icon" type="image/png" href="../../images/photo.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-08-06"/>
<meta property="article:created" itemprop="dateCreated" content="2021-08-06"/>
<meta name="article:author" content="Christopher M. Loan"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Christopher Loan&#39;s Website: APA 2021 Supplemental Material"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, &amp; Keith Zvoch"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Christopher Loan&#39;s Website"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Christopher Loan&#39;s Website: APA 2021 Supplemental Material"/>
<meta property="twitter:description" content="Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, &amp; Keith Zvoch"/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output","draft"]}},"value":[{"type":"character","attributes":{},"value":["APA 2021 Supplemental Material"]},{"type":"character","attributes":{},"value":["Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, & Keith Zvoch"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Christopher M. Loan"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["2021-08-06"]},{"type":"character","attributes":{},"value":["Collaboration","Conference","Machine Learning","Multi-Level Modeling","MLM","Plotting","Simulated Data","Tutorial"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","code_folding","toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["show code"]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"logical","attributes":{},"value":[false]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["apa-2021_files/anchor-4.2.2/anchor.min.js","apa-2021_files/bowser-1.9.3/bowser.min.js","apa-2021_files/distill-2.2.21/template.v2.js","apa-2021_files/figure-html5/dichot plot-1.png","apa-2021_files/figure-html5/figure 1-1.png","apa-2021_files/figure-html5/figure 2-1.png","apa-2021_files/figure-html5/glmertree plotted in ggplot-1.png","apa-2021_files/figure-html5/plot ranef 1-1.png","apa-2021_files/figure-html5/plot tree 00-1.png","apa-2021_files/figure-html5/plot tree 1-1.pdf","apa-2021_files/figure-html5/plot tree 1-1.png","apa-2021_files/figure-html5/plot tree 1-2.png","apa-2021_files/figure-html5/plot tree 1, l-page-1.png","apa-2021_files/figure-html5/plot tree 2-1.pdf","apa-2021_files/figure-html5/plot tree 2-1.png","apa-2021_files/figure-html5/plot tree 3-1.pdf","apa-2021_files/figure-html5/plot tree 3-1.png","apa-2021_files/figure-html5/plot tree 4-1.png","apa-2021_files/figure-html5/plot_ranef_1-1.png","apa-2021_files/figure-html5/unnamed-chunk-1-1.pdf","apa-2021_files/figure-html5/unnamed-chunk-1-1.png","apa-2021_files/figure-html5/unnamed-chunk-1-2.png","apa-2021_files/figure-html5/unnamed-chunk-2-1.png","apa-2021_files/figure-html5/unnamed-chunk-2-2.png","apa-2021_files/figure-html5/unnamed-chunk-3-1.png","apa-2021_files/figure-html5/unnamed-chunk-3-2.png","apa-2021_files/header-attrs-2.6/header-attrs.js","apa-2021_files/jquery-1.11.3/jquery.min.js","apa-2021_files/popper-2.6.0/popper.min.js","apa-2021_files/tippy-6.2.7/tippy-bundle.umd.min.js","apa-2021_files/tippy-6.2.7/tippy-light-border.css","apa-2021_files/tippy-6.2.7/tippy.css","apa-2021_files/tippy-6.2.7/tippy.umd.min.js","apa-2021_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.6/header-attrs.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<style type="text/css">

/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */

@import url('https://fonts.googleapis.com/css2?family=Antic+Slab&family=Raleway:ital@0;1&family=Source+Code+Pro:ital,wght@1,300&display=swap');

body {
  font-family: 'Raleway', sans-serif;
  background-color: #072a46d1;
  color: rgb(255 255 255);
}

figcaption, .figcaption {
    color: rgb(255 255 255 / 80%);
}

d-byline h3 {
    font-size: 0.6rem;
    font-weight: 400;
    color: rgb(255 255 255);
    margin: 0;
    text-transform: uppercase;
}

d-byline a, d-article d-byline a {
    color: rgb(255 255 255);
    text-decoration: none;
    border-bottom: none;
}

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     rgb(255 255 255);
  --header-color:    rgb(255 255 255);
  --body-color:      rgb(255 255 255);
  --aside-color:     rgb(255 255 255);
  --fig-cap-color:   rgb(255 255 255);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  color: rgb(255 255 255);
  background-color: rgb(120 157 175);
  --heading-size:    0.6rem;
  --heading-color:   rgb(255 255 255);
  --body-size:       0.8rem;
  --body-color:      rgb(255 255 255);
}

d-article {
  color: rgb(255 255 255);
}


/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgb(255 255 255);
  --text-size:       0.8em;
  --text-color:      rgb(255 255 255);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgb(255 255 255)
  --text-size:        15px;
  --hover-color:      white;
  background-color: #000000;
  border-top-color: #184eb9;
  border-left-color: #184eb9;
  border-right-color: #184eb9;
  border-top-width: 4px;
  border-left-width: 2px;
  border-right-width: 2px;
  border-bottom-color: rgb(255 255 255/65%);
  border-bottom-width: 2px;
  font-size: 18px;
  text-transform: lowercase;
}

.distill-site-footer {
  --text-color:       rgb(255 255 255)
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000000;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

/* table articles */
d-article table {
    background-color: #040f2d30;
    border-collapse: collapse;
    margin-bottom: 1.5rem;
    border-top: 1px solid rgb(255 255 255);
    border-bottom: 1px solid rgb(255 255 255);
}

/* background of code  */
d-article div.sourceCode {
    background-color: #2a445b;
}

/* floats */
code span.fl {
    color: #05d677;
}

/* logical */
code span.cn {
    color: #ff9a00;
}
/* operators*/
code span.op {
    color: #ffa0a0;
}

/* comment */
code span.co {
    color: #ababab;
}

/* code */
code span.va {
    color: rgb(255 255 255);
}

/* strings */
code span.st {
    color: #f3ff90;
}

/* code */
.sourceCode {
    color: rgb(255 255 255);
    overflow: visible;
}

/* functions */
code span.fu {
    color: #93d0ff;
}

/* links */
a {
    border-bottom: 3px solid #cc0000;
}


/* visited link */
d-article a {
  color: lightblue;
  border-bottom: 3px solid #cc0000;
}


/* mouse over link */
a:hover {
  color: hotpink;
  text-transform: uppercase;
  background-color: #072a469e;
}

/* selected link 
a:active {
  color: blue;
}
*/


.nav-dropdown {
    display: inline-block;
    position: relative;
    border-bottom: 3px solid #cc0000;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    font-size: 14px;
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
}

.distill-site-header .title {
    padding-left: 0px;
    text-transform: capitalize;
}

@media (min-width: $max-width) {
  .full-width {
    margin-left: calc(50% - 50vw);
    margin-right: calc(50% - 50vw);
  }
}

code {
    white-space: pre;
    color: rgb(255 255 255/65%);
    background-color: rgb(42 68 91);
}

/* Category tags */
.dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgb(255 255 255);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
    background-color: rgb(120 157 175);
}

.nav-dropdown .nav-dropbtn {
    border: none;
    text-transform: lowercase;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
}

.nav-dropdown .nav-dropbtn:hover {
  text-transform: uppercase;
}
</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"APA 2021 Supplemental Material","description":"Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, & Keith Zvoch","authors":[{"author":"Christopher M. Loan","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-08-06T00:00:00.000-07:00","citationText":"Loan, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo">
<img src="../../images/photo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">Christopher Loan's Website</a>
</div>
<div class="nav-right">
<a href="../../index.html">
<i class="fa fa-home" aria-hidden="true"></i>
</a>
<a href="../../blog.html">Blog</a>
<a href="../../about.html">Abbreviated CV</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Links to Additional Projects
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://chhr1s.github.io/GA_DOE_Public/index.html">Inequity FlexDashboard</a>
<a href="https://chhr1s.shinyapps.io/Neural_Net_Predictions/">Shiny App Neural Net (Beta)</a>
<a href="https://chhr1s.shinyapps.io/Loan_Merly_EDLD653_FInal/">Data &amp; Plot Downloader</a>
</div>
</div>
<a href="https://github.com/Chhr1s">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/christopher-loan-09965950/">
<i class="fa fa-linkedin" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>APA 2021 Supplemental Material</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../blog.html#category:Collaboration" class="dt-tag">Collaboration</a>
  <a href="../../blog.html#category:Conference" class="dt-tag">Conference</a>
  <a href="../../blog.html#category:Machine_Learning" class="dt-tag">Machine Learning</a>
  <a href="../../blog.html#category:Multi-Level_Modeling" class="dt-tag">Multi-Level Modeling</a>
  <a href="../../blog.html#category:MLM" class="dt-tag">MLM</a>
  <a href="../../blog.html#category:Plotting" class="dt-tag">Plotting</a>
  <a href="../../blog.html#category:Simulated_Data" class="dt-tag">Simulated Data</a>
  <a href="../../blog.html#category:Tutorial" class="dt-tag">Tutorial</a>
</div>
<!--/radix_placeholder_categories-->
<p>Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, &amp; Keith Zvoch</p>
</div>

<div class="d-byline">
  Christopher M. Loan true 
  
<br/>2021-08-06
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#background">Background</a>
<ul>
<li><a href="#load-libraries">load libraries</a></li>
<li><a href="#simulating-data">simulating data</a></li>
</ul></li>
<li><a href="#fitting-generalized-linear-mixed-effects-model-regression-glmm-trees-via-glmertree">Fitting Generalized Linear Mixed Effects Model Regression (GLMM) Trees via <code>{glmertree}</code></a>
<ul>
<li><a href="#model-1-fully-exploratory">Model 1: Fully Exploratory</a></li>
<li><a href="#model-2-modify-hyperparameters">Model 2: Modify hyperparameters</a></li>
<li><a href="#model-3-add-fixed-effects">Model 3: add fixed effects</a></li>
</ul></li>
<li><a href="#visualizing-the-data">Visualizing the Data</a></li>
<li><a href="#going-beyond-significance">Going beyond significance</a></li>
<li><a href="#references-recommended-reading">References &amp; Recommended Reading</a></li>
</ul>
</nav>
</div>
<h1 id="background">Background</h1>
<p>The purpose of these supplemental materials is to walk users through a few models and technical details associated with the <code>{glmertree}</code> package and provide references/supplemental reading for our poster. Refer to the Table of Contents (or scroll down) if you’re just here for references &amp; recommended reading.</p>
<p>For readability, code is included but can be shown/hidden by clicking <code>show code</code>.</p>
<h2 id="load-libraries">load libraries</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>glmertree</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/martin-borkovec/ggparty'>ggparty</a></span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="simulating-data">simulating data</h2>
<p>For data privacy, I’m using simulated data to walk you through these models. If you don’t care about the simulation and just want to see model specification, keep reading; you’re in the right place! If you’re interested in knowing how I simulated the data, check out <a href="https://www.christopherloan.com/blog/simulating-2-level-data-for-apa-2021-supplemental/">this blog post of mine</a>.</p>
<p>I made a complex interaction term that would not be easily detected by a multilevel model (MLM), and showed how you would have to <a href="https://www.christopherloan.com/blog/simulating-2-level-data-for-apa-2021-supplemental/">specify the fixed effects</a> to appropriately approximate the data. This basically resulted in a 3-way interaction that would be highly unlikely to be theorized in multimodal approached, barring strong theoretical evidence or equally strong analyst capability (e.g., to draw associations from graphic exploration of the data).</p>
<p>We have 15 level 1 units for each level 2 unit and 71 level 2 units (labeled with <code>id</code>). The level 1 intercept of <code>outcome</code> is 4.25 with a main effect of 1.25 for <code>x</code>, 2.00 for <code>z</code>. The function also makes a nuisance variable <code>w</code>, which does not contribute to <code>outcome</code> at all.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim_dat</span> <span class='op'>&lt;-</span>
  <span class='fu'>simulate_nonlinear_intx</span><span class='op'>(</span>
    n <span class='op'>=</span> <span class='fl'>15</span>, <span class='co'>## number level 1 units at each level 2</span>
    j <span class='op'>=</span> <span class='fl'>71</span>, <span class='co'>## number level 2 units</span>
    intercept_lv1 <span class='op'>=</span> <span class='fl'>4.25</span>, <span class='co'>## intercept at level 1</span>
    main_x <span class='op'>=</span> <span class='fl'>1.25</span>, <span class='co'>## main effect of x</span>
    main_z <span class='op'>=</span> <span class='fl'>2.00</span>, <span class='co'>## main effect of z</span>
    interaction1 <span class='op'>=</span> <span class='op'>-</span><span class='fl'>4</span>, <span class='co'>## interaction of x and z when product &lt; 0</span>
    interaction2 <span class='op'>=</span> <span class='fl'>4</span>, <span class='co'>## interaction of x and z when product &gt;= 0</span>
    residual_var_sd_lv1 <span class='op'>=</span> <span class='fl'>2.00</span>, <span class='co'>## standard deviation of residuals at level 1</span>
    random_int_mean_lv2 <span class='op'>=</span> <span class='fl'>0</span>, <span class='co'>## mean of random intercept at level 2</span>
    random_int_sd_lv2 <span class='op'>=</span> <span class='fl'>1.00</span>, <span class='co'>## standard deviation of random intercept at level 2,</span>
    start_seed <span class='op'>=</span> <span class='fl'>123</span> <span class='co'>## ensure you can reproduce </span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>GLMM trees should be able to find heterogeneity in the association of <code>outcome</code> and <code>x</code> (or <code>z</code>, it doesn’t matter) and explain differential effects of <code>z</code> and <code>x</code> without analyst knowledge of a complex higher-order interaction (i.e., <em>n</em>-way interactions when <em>n</em> &gt; 2).</p>
<h1 id="fitting-generalized-linear-mixed-effects-model-regression-glmm-trees-via-glmertree">Fitting Generalized Linear Mixed Effects Model Regression (GLMM) Trees via <code>{glmertree}</code></h1>
<p>Specifying models with <code>{glmertree}</code> is similar to multilevel models (MLM) with <code>{lme4}</code>. However, rather than <em>adding</em> random effects with <code>{lme4}</code>, you specify the model as follows: <code>forumla = outcome ~ fixed effects | random effects | splitting variables</code>.</p>
<p>A second consideration when fitting GLMM trees is the model’s use of parameter instability tests; therefore, we need to account for cluster covariances in this process, so you want to specify the <code>id</code> variable to the <code>cluster = id</code> argument as well as in the specified formula. As far as I know, the current implementation only allows a 2 level structure, even if the MLM</p>
<h2 id="model-1-fully-exploratory">Model 1: Fully Exploratory</h2>
<p>Let’s run a very exploratory model here. This is everything but the kitchen sink: an intercept-only model, with random intercept for each level 2 unit, and allowing splits to be made by any of the variables in the data.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_1</span> <span class='op'>&lt;-</span> 
  <span class='fu'>lmertree</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_dat</span>, 
    formula <span class='op'>=</span> 
      <span class='va'>outcome</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>|</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>z</span> <span class='op'>+</span> <span class='va'>w</span>, 
    cluster <span class='op'>=</span> <span class='va'>id</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Let’s look at plotted results first. Here are the random effects, presented as a caterpillar plot. These random effects will be used as offsets in the linear models fit within each node, if you interpret the model from the one-level with multiple node framework (i.e., from <code>summary(tree_1$tree)</code>)</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>tree_1</span>, which <span class='op'>=</span> <span class='st'>'ranef'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>$id</code></pre>
<p><img src="apa-2021_files/figure-html5/plot_ranef_1-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>custom_boxplot</span> <span class='op'>&lt;-</span> 
  <span class='kw'>function</span><span class='op'>(</span>
    <span class='va'>glmertree_object</span>,
    <span class='va'>write_labels</span> <span class='op'>=</span> <span class='cn'>F</span>
  <span class='op'>)</span><span class='op'>{</span>
    <span class='va'>format</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>geom_edge</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span>,
    <span class='fu'>geom_node_label</span><span class='op'>(</span>
      <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>splitvar</span><span class='op'>)</span>,
      ids <span class='op'>=</span> <span class='st'>"inner"</span><span class='op'>)</span>,
    <span class='fu'>geom_node_plot</span><span class='op'>(</span>
        gglist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
          <span class='fu'>geom_boxplot</span><span class='op'>(</span>
            <span class='fu'>aes</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>outcome</span><span class='op'>)</span>, 
            size <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
          <span class='fu'>theme_minimal</span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,
          <span class='fu'>theme</span><span class='op'>(</span>
            axis.title.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
            axis.text.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
            axis.line.y <span class='op'>=</span> <span class='fu'>element_line</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span>,
            panel.grid.minor.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>
            <span class='op'>)</span><span class='op'>)</span>,
        shared_axis_labels <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    <span class='fu'>geom_node_label</span><span class='op'>(</span>
      line_list <span class='op'>=</span> 
        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
          <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>splitvar</span><span class='op'>)</span>,
          <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'N = '</span> , <span class='va'>nodesize</span><span class='op'>)</span><span class='op'>)</span>,
          <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>p.value</span> <span class='op'>&lt;</span> <span class='fl'>0.001</span>, <span class='st'>"p &lt; 0.001"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>'p = '</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>p.value</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
      line_gpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span>,
        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,
        <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>,
      ids <span class='op'>=</span> <span class='st'>"inner"</span><span class='op'>)</span>,
    <span class='fu'>geom_node_label</span><span class='op'>(</span>
      <span class='fu'>aes</span><span class='op'>(</span>
        label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"N = "</span>, <span class='va'>nodesize</span><span class='op'>)</span>
        <span class='op'>)</span>,
      ids <span class='op'>=</span> <span class='st'>"terminal"</span>, 
      line_gpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>
      <span class='op'>)</span>
    <span class='op'>)</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>write_labels</span> <span class='op'>==</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span>
        <span class='fu'>ggparty</span><span class='op'>(</span><span class='va'>glmertree_object</span><span class='op'>$</span><span class='va'>tree</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>geom_edge_label</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>format</span>
        <span class='op'>)</span>
    <span class='op'>}</span>
    <span class='kw'>else</span> <span class='op'>{</span><span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'>ggparty</span><span class='op'>(</span><span class='va'>glmertree_object</span><span class='op'>$</span><span class='va'>tree</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>format</span><span class='op'>)</span><span class='op'>}</span>
  <span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<p>Here’s a printed (instead of plotted) tree diagram. This diagram is too large to print easily, so it’s obviously more complex than we want:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_1</span><span class='op'>$</span><span class='va'>tree</span>
</code></pre>
</div>
</details>
<pre><code>Linear model tree

Model formula:
outcome ~ 1 | x + z + w

Fitted party:
[1] root
|   [2] z &lt;= 1.05788
|   |   [3] x &lt;= 0.92647
|   |   |   [4] z &lt;= 0.37947
|   |   |   |   [5] x &lt;= 0.66556
|   |   |   |   |   [6] x &lt;= -1.81567: n = 10
|   |   |   |   |       (Intercept) 
|   |   |   |   |          7.955253 
|   |   |   |   |   [7] x &gt; -1.81567
|   |   |   |   |   |   [8] z &lt;= 0.1324
|   |   |   |   |   |   |   [9] x &lt;= -0.89285
|   |   |   |   |   |   |   |   [10] z &lt;= -0.50041
|   |   |   |   |   |   |   |   |   [11] z &lt;= -1.26949: n = 12
|   |   |   |   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |   |   |   |           8.72907 
|   |   |   |   |   |   |   |   |   [12] z &gt; -1.26949: n = 33
|   |   |   |   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |   |   |   |          5.658304 
|   |   |   |   |   |   |   |   [13] z &gt; -0.50041: n = 35
|   |   |   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |   |   |            3.1839 
|   |   |   |   |   |   |   [14] x &gt; -0.89285
|   |   |   |   |   |   |   |   [15] x &lt;= 0.23029
|   |   |   |   |   |   |   |   |   [16] z &lt;= -0.89841
|   |   |   |   |   |   |   |   |   |   [17] x &lt;= -0.26504: n = 42
|   |   |   |   |   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |   |   |   |   |          4.032858 
|   |   |   |   |   |   |   |   |   |   [18] x &gt; -0.26504: n = 47
|   |   |   |   |   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |   |   |   |   |          1.914251 
|   |   |   |   |   |   |   |   |   [19] z &gt; -0.89841: n = 155
|   |   |   |   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |   |   |   |          4.057118 
|   |   |   |   |   |   |   |   [20] x &gt; 0.23029: n = 99
|   |   |   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |   |   |          4.654456 
|   |   |   |   |   |   [21] z &gt; 0.1324: n = 77
|   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |          5.229926 
|   |   |   |   [22] x &gt; 0.66556: n = 72
|   |   |   |       (Intercept) 
|   |   |   |          6.074059 
|   |   |   [23] z &gt; 0.37947: n = 164
|   |   |       (Intercept) 
|   |   |          6.806958 
|   |   [24] x &gt; 0.92647
|   |   |   [25] z &lt;= 0.56022
|   |   |   |   [26] z &lt;= -0.76973
|   |   |   |   |   [27] x &lt;= 1.33385: n = 19
|   |   |   |   |       (Intercept) 
|   |   |   |   |           8.61226 
|   |   |   |   |   [28] x &gt; 1.33385: n = 23
|   |   |   |   |       (Intercept) 
|   |   |   |   |          12.99779 
|   |   |   |   [29] z &gt; -0.76973
|   |   |   |   |   [30] z &lt;= 0.31077
|   |   |   |   |   |   [31] z &lt;= -0.31704: n = 33
|   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |          8.141308 
|   |   |   |   |   |   [32] z &gt; -0.31704: n = 39
|   |   |   |   |   |       (Intercept) 
|   |   |   |   |   |          6.283608 
|   |   |   |   |   [33] z &gt; 0.31077: n = 21
|   |   |   |   |       (Intercept) 
|   |   |   |   |          9.217174 
|   |   |   [34] z &gt; 0.56022: n = 26
|   |   |       (Intercept) 
|   |   |          12.82893 
|   [35] z &gt; 1.05788
|   |   [36] x &lt;= 1.13431
|   |   |   [37] z &lt;= 1.95389
|   |   |   |   [38] x &lt;= -0.99028: n = 16
|   |   |   |       (Intercept) 
|   |   |   |          14.03631 
|   |   |   |   [39] x &gt; -0.99028
|   |   |   |   |   [40] x &lt;= 0.53007: n = 70
|   |   |   |   |       (Intercept) 
|   |   |   |   |          9.506037 
|   |   |   |   |   [41] x &gt; 0.53007: n = 30
|   |   |   |   |       (Intercept) 
|   |   |   |   |          12.58756 
|   |   |   [42] z &gt; 1.95389: n = 17
|   |   |       (Intercept) 
|   |   |          15.56201 
|   |   [43] x &gt; 1.13431
|   |   |   [44] z &lt;= 1.58438: n = 15
|   |   |       (Intercept) 
|   |   |          16.82666 
|   |   |   [45] z &gt; 1.58438: n = 10
|   |   |       (Intercept) 
|   |   |          23.86421 

Number of inner nodes:    22
Number of terminal nodes: 23
Number of parameters per node: 1
Objective function (residual sum of squares): 5187.452</code></pre>
</div>
<p>It looks like our model has identified too many splits for this to extract meaningful interpretations We gain knowledge that <code>x</code> and <code>z</code> are the variables that contribute to the outcome. The model is never presenting <code>w</code> as a variable influencing splitting when there is so much more heterogeneity in levels of <code>z</code> and <code>x</code>. We can prevent the model from building such a large tree with the <code>maxdepth</code> parameter. We’ll get broader strokes of the process, but will be less likely to overfit the data.</p>
<p><strong>NOTE:</strong> For consistency when knitting the document, I actually wrote a custom function (above) to make <code>{ggparty}</code> plotting easy across the project, but you can also just use <code>plot(tree_1, which = 'tree')</code>.</p>
<p>There are two ways we could begin working to make results which can be interpreted. One is to just tune hyperparameters. The other is to add fixed effects, which we’ll do later.</p>
<h2 id="model-2-modify-hyperparameters">Model 2: Modify hyperparameters</h2>
<p>Hyperparameters are parameters that can be specified by the researcher; these parameters influence the estimation of the parameters in the model. These are common for machine learning, and those relevant to GLMM trees are any that are relevant to decision trees or parameter instability tests (see <a href="https://cran.r-project.org/web/packages/partykit/partykit.pdf"><code>{partykit}</code></a>).</p>
<p>I’ll point you towards a few and their defaults.</p>
<ul>
<li><code>bonferroni = TRUE</code>: Bonferroni corrects <em>p</em>-values. Recommended to leave on.</li>
<li><code>alpha = 0.05</code>: <em>p</em>-value indicated significant parameter stability (e.g., <code>alpha = 0.001</code>).</li>
<li><code>minsize = NULL</code>: the minimum cases allowed in the terminal node. The larger you make this, the more of the sample has to be in a node for you to trust there is generalize-able heterogeneity and not just noise in your data (e.g., <code>minsize = 0.10*nrow(your_data_set)</code>)</li>
<li><code>trim = NULL</code>: this specifies the percentage (if &lt; 0) or number (if &gt; 0) of outliers to be be omitted from the parameter instability tests. This is done to prevent undue influence of outliers, and does not influence group assignment/splitting; it is just used in testing.</li>
<li><code>maxdepth = Inf</code>: the depth of the tree that’s allowed to grow. This functionally decreases the level of interactions you allow the data to find.</li>
</ul>
<p>These should be tuned carefully and resulting models are ideally discussed with content experts and compared to prior research for validity.</p>
<p>Let’s re-run this with some more stringent hyperparameters and see how the model explains relation of <code>x</code>, <code>z</code>, and <code>outcome</code>. Since this grew such a deep tree, that’s the first hyperparameter I’ll tune.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_2</span> <span class='op'>&lt;-</span> 
  <span class='fu'>lmertree</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_dat</span>, 
    formula <span class='op'>=</span> 
      <span class='va'>outcome</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>|</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>w</span> <span class='op'>+</span> <span class='va'>z</span> <span class='op'>+</span> <span class='va'>x</span>, 
    cluster <span class='op'>=</span> <span class='va'>id</span>, 
    maxdepth <span class='op'>=</span> <span class='fl'>3</span>, 
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>custom_boxplot</span><span class='op'>(</span><span class='va'>tree_2</span>, write_labels <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="apa-2021_files/figure-html5/plot%20tree%202-1.png" width="768" /></p>
</div>
<h2 id="model-3-add-fixed-effects">Model 3: add fixed effects</h2>
<p>The <code>p &lt; 0.001</code> on the nodes indicate the parameter instability test is significant and the 2 models explain more variance in the data than 1 model (repeated at subsequent nodes, too). The value for the test can be found via <code>partykit::sctest.modelparty(glmertree_model$tree, type = c("chow"), asymptotic = F)</code> when your model name is <code>glmertree_model</code>. If these were barely <em>p</em> &lt; 0.05, I would likely tune this next. Also, this model looks fairly interprettable.</p>
<p>This is saying <code>z</code> being ~1 standard deviation above its mean, the outcome is highest. When it’s lower than that, it’s lower. Within these cases, <code>outcome</code> appears to be higher when <code>x</code> is higher. This suggests an interaction of <code>x</code> and <code>z</code>. We could now see what the relationship of <code>x</code> to the outcome is for different values of <code>z</code>, by adding it as a fixed effect.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_3</span> <span class='op'>&lt;-</span> 
  <span class='fu'>lmertree</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_dat</span>, 
    formula <span class='op'>=</span> 
      <span class='va'>outcome</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>|</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>w</span> <span class='op'>+</span> <span class='va'>z</span> <span class='op'>+</span> <span class='va'>x</span>, 
    cluster <span class='op'>=</span> <span class='va'>id</span>, 
    maxdepth <span class='op'>=</span> <span class='fl'>3</span>, 
    trim <span class='op'>=</span> <span class='fl'>0.1</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>custom_scatter_lm</span> <span class='op'>&lt;-</span>
  <span class='kw'>function</span><span class='op'>(</span>
    <span class='va'>glmertree_object</span>
  <span class='op'>)</span><span class='op'>{</span>
    <span class='fu'>ggparty</span><span class='op'>(</span><span class='va'>glmertree_object</span><span class='op'>$</span><span class='va'>tree</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_edge</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_edge_label</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_node_label</span><span class='op'>(</span>
      <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>splitvar</span><span class='op'>)</span>,
      ids <span class='op'>=</span> <span class='st'>"inner"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_node_plot</span><span class='op'>(</span>
      gglist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
        <span class='fu'>geom_point</span><span class='op'>(</span>
          <span class='fu'>aes</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>outcome</span>, x <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>, 
          size <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
        <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>'lm'</span>, <span class='fu'>aes</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>outcome</span>, x <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>,
        <span class='fu'>theme_minimal</span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span>,
        <span class='fu'>theme</span><span class='op'>(</span>
          axis.line.y <span class='op'>=</span> <span class='fu'>element_line</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span>,
          panel.grid.minor.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>
          <span class='op'>)</span><span class='op'>)</span>,
      shared_axis_labels <span class='op'>=</span> <span class='cn'>TRUE</span>,
      scales <span class='op'>=</span> <span class='st'>'free_x'</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_node_label</span><span class='op'>(</span>
    line_list <span class='op'>=</span> 
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
        <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>splitvar</span><span class='op'>)</span>,
        <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'N = '</span> , <span class='va'>nodesize</span><span class='op'>)</span><span class='op'>)</span>,
        <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>p.value</span> <span class='op'>&lt;</span> <span class='fl'>0.001</span>, <span class='st'>"p &lt; 0.001"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>'p = '</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>p.value</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
    line_gpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>,
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>,
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span>,
    ids <span class='op'>=</span> <span class='st'>"inner"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_node_label</span><span class='op'>(</span>
    <span class='fu'>aes</span><span class='op'>(</span>
      label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"N = "</span>, <span class='va'>nodesize</span><span class='op'>)</span>
      <span class='op'>)</span>,
    ids <span class='op'>=</span> <span class='st'>"terminal"</span>, 
    line_gpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'>labs</span><span class='op'>(</span>caption <span class='op'>=</span> <span class='st'>'note x axes are free'</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'>theme</span><span class='op'>(</span>plot.caption <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>custom_scatter_lm</span><span class='op'>(</span><span class='va'>tree_3</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="apa-2021_files/figure-html5/plot%20tree%203-1.png" width="768" /></p>
</div>
<p>We now see a more nuanced description of the relationship of <code>x</code> to <code>outcome</code> at different levels of <code>z</code>, and the subgroups are slightly different than in <code>tree_2</code>. When <code>z</code> is large, we see larger average <code>outcome</code> (i.e., intercept) than when <code>z</code> is lower. On both halves of the plot, it looks like the relationship of <code>x</code> and <code>outcome</code> is negative when <code>x &lt; 0</code>, but is positive when <code>x &gt; 0</code>. Let’s put these onto one plot and see what it looks like.</p>
<h1 id="visualizing-the-data">Visualizing the Data</h1>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>figure_1a</span> <span class='op'>&lt;-</span>   
  <span class='va'>sim_dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>node <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>tree_3</span>, type <span class='op'>=</span> <span class='st'>'node'</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>outcome</span>, group <span class='op'>=</span> <span class='va'>node</span>, color <span class='op'>=</span> <span class='va'>node</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>'lm'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='va'>project_theme</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>'Model fit by glmertree'</span>,
    <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>plot.subtitle <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span> 
<span class='va'>figure_1a</span>
</code></pre>
</div>
</details>
<p><img src="apa-2021_files/figure-html5/glmertree%20plotted%20in%20ggplot-1.png" width="1536" /></p>
</div>
<h1 id="going-beyond-significance">Going beyond significance</h1>
<p>The plot above shows that we created 4 linear models that explain the data very well. We also see, though, that the 2 models on the left overlap with one another, as do the 2 models on the right. This is where we would call in researchers that know the field. We would discuss the evidence in the data, compared to the theoretical possibilities of 4 versus 2 groups.</p>
<p>These 4 groups may be phenomena observed or the way the model is formed may influence the fact that we have 2 parallel lines. You see, since the tree structure is dependent upon the first split, the parameter instability tests do not go across branches to see if groups could be recombined to increase model fit</p>
<p>If an analyst were working with a theorist, they should discuss the implications of these 4 groups and find some way to demonstrate validity of 4 over 2 (as Occum’s Razor would suggest 2 is more likely than 4). If an analyst were working alone, I would suggests following up this with one final parameter instability test, comparing models with individual negative slopes to a single negative slope. Then, repeating this for 1 vs. 2 positive slopes.</p>
<p>Visually, two groups would look like this</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim_dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>node <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>tree_3</span>, type <span class='op'>=</span> <span class='st'>'node'</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
         dichot_node <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='fu'>if_else</span><span class='op'>(</span><span class='va'>node</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>7</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
         <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>outcome</span>, group <span class='op'>=</span> <span class='va'>dichot_node</span>, color <span class='op'>=</span> <span class='va'>dichot_node</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>'lm'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='va'>project_theme</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>'Collapsing Nodes'</span>,
    <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>plot.subtitle <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<p><img src="apa-2021_files/figure-html5/dichot%20plot-1.png" width="624" /></p>
</div>
<p>This looks like a reasonable model, which could explain not only the sample, but the population as it does for us (based on its similarity to the method of simulation). Random forest modifications could be useful to preventing such overfitting, but that will have to wait for another article.</p>
<h1 id="references-recommended-reading">References &amp; Recommended Reading</h1>
<p>Bates, D., Maechler, M., Bolker, B., &amp; Walker, S. (2015). Fitting Linear Mixed-Effects Models Using lme4. Journal of Statistical Software, 67(1), 1-48. <a href="doi:10.18637/jss.v067.i01" class="uri">doi:10.18637/jss.v067.i01</a>.</p>
<p>Fokkema, M., Edbrooke-Childs, J., &amp; Wolpert, M. (2020). Generalized linear mixed-model (GLMM) trees: A flexible decision-tree method for multilevel and longitudinal data. Psychotherapy Research, 31(3), 329-341.</p>
<p>Fokkema, M., Smits, N., Zeileis, A., Hothorn, T., &amp; Kelderman, H. (2018). Detecting treatment-subgroup interactions in clustered data with generalized linear mixed-effects model trees. Behavior research methods, 50(5), 2016-2034.</p>
<p>Hothorn, T. &amp; Zeileis, A. (2015). partykit: A Modular Toolkit for Recursive Partytioning in R. Journal of Machine Learning Research, 16, 3905-3909.</p>
<p>Hothorn, T., Hornik, K., &amp; Zeileis, A. (2006). Unbiased recursive partitioning: A conditional inference framework. Journal of Computational and Graphical statistics, 15(3), 651-674.</p>
<p>Hulleman, C. S., Godes, O., Hendricks, B. L., &amp; Harackiewicz, J. M. (2010). Enhancing interest and performance with a utility value intervention. Journal of educational psychology, 102(4), 880.</p>
<p>Borkovec, M. &amp; Madin, N. (2019). ggparty: ‘ggplot’ Visualizations for the ‘partykit’ Package. R package version 1.0.0.</p>
<p>Villanueva, I., Husman, J., Christensen, D., Youmans, K., Khan, M.T., Vicioso, P., Lampkins, S. and Graham, M.C., 2019. A Cross-Disciplinary and Multi-Modal Experimental Design for Studying Near-Real-Time Authentic Examination Experiences. JoVE (Journal of Visualized Experiments), (151), p.e60037.</p>
<p>Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686,</p>
<p>Zeileis, A. (2001). strucchange: Testing for structural change in linear regression relationships. R News, 1(3), 8-11.</p>
<p>Zeileis, A., Hothorn, T., &amp; Hornik, K. (2008). Model-based recursive partitioning. Journal of Computational and Graphical Statistics, 17(2), 492-514.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
