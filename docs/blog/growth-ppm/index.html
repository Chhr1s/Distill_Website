<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>Christopher Loan's Website: Introduction to Growth &amp; Parallel Process Models in `{lavaan}`</title>

<meta property="description" itemprop="description" content="A tutorial to parameterize and plot results of a parallel process model (PPM) in `{lavaan}`."/>

<link rel="icon" type="image/png" href="../../images/photo.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2020-09-08"/>
<meta property="article:created" itemprop="dateCreated" content="2020-09-08"/>
<meta name="article:author" content="Christopher Loan"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Christopher Loan&#39;s Website: Introduction to Growth &amp; Parallel Process Models in `{lavaan}`"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A tutorial to parameterize and plot results of a parallel process model (PPM) in `{lavaan}`."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Christopher Loan&#39;s Website"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Christopher Loan&#39;s Website: Introduction to Growth &amp; Parallel Process Models in `{lavaan}`"/>
<meta property="twitter:description" content="A tutorial to parameterize and plot results of a parallel process model (PPM) in `{lavaan}`."/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output"]}},"value":[{"type":"character","attributes":{},"value":["Introduction to Growth & Parallel Process Models in `{lavaan}`"]},{"type":"character","attributes":{},"value":["A tutorial to parameterize and plot results of a parallel process model (PPM) in `{lavaan}`."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Christopher Loan"]}]}]},{"type":"character","attributes":{},"value":["2020-09-08"]},{"type":"character","attributes":{},"value":["SEM","Structural Equation Modeling","Mediation","Bootstrapping","Plotting","Simulated Data","Tutorial","Model Comparisons"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","code_folding","toc","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["show code"]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["growth-ppm_files/anchor-4.2.2/anchor.min.js","growth-ppm_files/bowser-1.9.3/bowser.min.js","growth-ppm_files/distill-2.2.21/template.v2.js","growth-ppm_files/figure-html5/unnamed-chunk-19-1.png","growth-ppm_files/figure-html5/unnamed-chunk-20-1.png","growth-ppm_files/figure-html5/unnamed-chunk-21-1.png","growth-ppm_files/figure-html5/unnamed-chunk-22-1.png","growth-ppm_files/figure-html5/unnamed-chunk-5-1.png","growth-ppm_files/figure-html5/unnamed-chunk-6-1.png","growth-ppm_files/figure-html5/unnamed-chunk-7-1.png","growth-ppm_files/header-attrs-2.6/header-attrs.js","growth-ppm_files/jquery-1.11.3/jquery.min.js","growth-ppm_files/popper-2.6.0/popper.min.js","growth-ppm_files/tippy-6.2.7/tippy-bundle.umd.min.js","growth-ppm_files/tippy-6.2.7/tippy-light-border.css","growth-ppm_files/tippy-6.2.7/tippy.css","growth-ppm_files/tippy-6.2.7/tippy.umd.min.js","growth-ppm_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.6/header-attrs.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<style type="text/css">

/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */

@import url('https://fonts.googleapis.com/css2?family=Antic+Slab&family=Raleway:ital@0;1&family=Source+Code+Pro:ital,wght@1,300&display=swap');

body {
  font-family: 'Raleway', sans-serif;
  background-color: #072a46d1;
  color: rgb(255 255 255);
}

figcaption, .figcaption {
    color: rgb(255 255 255 / 80%);
}

d-byline h3 {
    font-size: 0.6rem;
    font-weight: 400;
    color: rgb(255 255 255);
    margin: 0;
    text-transform: uppercase;
}

d-byline a, d-article d-byline a {
    color: rgb(255 255 255);
    text-decoration: none;
    border-bottom: none;
}

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     rgb(255 255 255);
  --header-color:    rgb(255 255 255);
  --body-color:      rgb(255 255 255);
  --aside-color:     rgb(255 255 255);
  --fig-cap-color:   rgb(255 255 255);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  color: rgb(255 255 255);
  background-color: rgb(120 157 175);
  --heading-size:    0.6rem;
  --heading-color:   rgb(255 255 255);
  --body-size:       0.8rem;
  --body-color:      rgb(255 255 255);
}

d-article {
  color: rgb(255 255 255);
}


/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgb(255 255 255);
  --text-size:       0.8em;
  --text-color:      rgb(255 255 255);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgb(255 255 255)
  --text-size:        15px;
  --hover-color:      white;
  background-color: #000000;
  border-top-color: #184eb9;
  border-left-color: #184eb9;
  border-right-color: #184eb9;
  border-top-width: 4px;
  border-left-width: 2px;
  border-right-width: 2px;
  border-bottom-color: rgb(255 255 255/65%);
  border-bottom-width: 2px;
  font-size: 18px;
  text-transform: lowercase;
}

.distill-site-footer {
  --text-color:       rgb(255 255 255)
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #000000;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

/* table articles */
d-article table {
    background-color: #040f2d30;
    border-collapse: collapse;
    margin-bottom: 1.5rem;
    border-top: 1px solid rgb(255 255 255);
    border-bottom: 1px solid rgb(255 255 255);
}

/* background of code  */
d-article div.sourceCode {
    background-color: #2a445b;
}

/* floats */
code span.fl {
    color: #05d677;
}

/* logical */
code span.cn {
    color: #ff9a00;
}
/* operators*/
code span.op {
    color: #ffa0a0;
}

/* comment */
code span.co {
    color: #ababab;
}

/* code */
code span.va {
    color: rgb(255 255 255);
}

/* strings */
code span.st {
    color: #f3ff90;
}

/* code */
.sourceCode {
    color: rgb(255 255 255);
    overflow: visible;
}

/* functions */
code span.fu {
    color: #93d0ff;
}

/* links */
a {
    border-bottom: 3px solid #cc0000;
}


/* visited link */
d-article a {
  color: lightblue;
  border-bottom: 3px solid #cc0000;
}


/* mouse over link */
a:hover {
  color: hotpink;
  text-transform: uppercase;
  background-color: #072a469e;
}

/* selected link 
a:active {
  color: blue;
}
*/


.nav-dropdown {
    display: inline-block;
    position: relative;
    border-bottom: 3px solid #cc0000;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    font-size: 14px;
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
}

.distill-site-header .title {
    padding-left: 0px;
    text-transform: capitalize;
}

@media (min-width: $max-width) {
  .full-width {
    margin-left: calc(50% - 50vw);
    margin-right: calc(50% - 50vw);
  }
}

code {
    white-space: pre;
    color: rgb(255 255 255/65%);
    background-color: rgb(42 68 91);
}

/* Category tags */
.dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgb(255 255 255);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
    background-color: rgb(120 157 175);
}

.nav-dropdown .nav-dropbtn {
    border: none;
    text-transform: lowercase;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
}

.nav-dropdown .nav-dropbtn:hover {
  text-transform: uppercase;
}
</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Introduction to Growth & Parallel Process Models in `{lavaan}`","description":"A tutorial to parameterize and plot results of a parallel process model (PPM) in `{lavaan}`.","authors":[{"author":"Christopher Loan","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2020-09-08T00:00:00.000-07:00","citationText":"Loan, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo">
<img src="../../images/photo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">Christopher Loan's Website</a>
</div>
<div class="nav-right">
<a href="../../index.html">
<i class="fa fa-home" aria-hidden="true"></i>
</a>
<a href="../../blog.html">Blog</a>
<a href="../../about.html">Abbreviated CV</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Links to Additional Projects
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://chhr1s.github.io/GA_DOE_Public/index.html">Inequity FlexDashboard</a>
<a href="https://chhr1s.shinyapps.io/Neural_Net_Predictions/">Shiny App Neural Net (Beta)</a>
<a href="https://chhr1s.shinyapps.io/Loan_Merly_EDLD653_FInal/">Data &amp; Plot Downloader</a>
</div>
</div>
<a href="https://github.com/Chhr1s">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/christopher-loan-09965950/">
<i class="fa fa-linkedin" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Introduction to Growth &amp; Parallel Process Models in {lavaan}</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../blog.html#category:SEM" class="dt-tag">SEM</a>
  <a href="../../blog.html#category:Structural_Equation_Modeling" class="dt-tag">Structural Equation Modeling</a>
  <a href="../../blog.html#category:Mediation" class="dt-tag">Mediation</a>
  <a href="../../blog.html#category:Bootstrapping" class="dt-tag">Bootstrapping</a>
  <a href="../../blog.html#category:Plotting" class="dt-tag">Plotting</a>
  <a href="../../blog.html#category:Simulated_Data" class="dt-tag">Simulated Data</a>
  <a href="../../blog.html#category:Tutorial" class="dt-tag">Tutorial</a>
  <a href="../../blog.html#category:Model_Comparisons" class="dt-tag">Model Comparisons</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>A tutorial to parameterize and plot results of a parallel process model (PPM) in <code>{lavaan}</code>.</p></p>
</div>

<div class="d-byline">
  Christopher Loan  
  
<br/>2020-09-08
</div>

<div class="d-article">
<div class="d-contents">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">Introduction:</a></li>
<li><a href="#load-packages">Load packages</a></li>
<li><a href="#simulating-data-for-demonstration">Simulating Data for Demonstration</a></li>
<li><a href="#fit-statistics">Fit statistics</a></li>
<li><a href="#steps-for-a-ppm">Steps for a PPM:</a></li>
<li><a href="#step-1.-plot-your-data">STEP 1. Plot your data</a></li>
<li><a href="#step-2.-assess-fit-of-various-models">STEP 2. Assess fit of various models</a>
<ul>
<li><a href="#function">Function</a></li>
<li><a href="#estimator">Estimator</a></li>
<li><a href="#missingness">Missingness</a></li>
</ul></li>
<li><a href="#step-3.-building-the-ppm">STEP 3. Building the PPM</a></li>
<li><a href="#full-model-fit">Full Model Fit</a></li>
<li><a href="#interpretation">Interpretation</a></li>
<li><a href="#bootstrapping">Bootstrapping</a></li>
<li><a href="#plotting">Plotting</a></li>
<li><a href="#next-steps">Next Steps:</a></li>
<li><a href="#looking-at-the-simulation-call">Looking at the simulation call</a></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-screen-inset">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"images"</span>, <span class='st'>"tomas-sobek.jpeg"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="/Users/christopherloan/Documents/Distill_Website/images/tomas-sobek.jpeg" width="1516" /></p>
</div>
<p>photo by <a href="https://unsplash.com/@tomas_nz">Tomas Sobek</a></p>
<h1 id="introduction">Introduction:</h1>
<p>During my MS, I had some research questions that were easily answered with structural equation modeling (SEM). I decided to learn <code>{lavaan}</code> because it’s open source and allows simple integration with other <code>R</code> packages. </p>
<p>Because I relied heavily on publicly available tutorials, I wanted to create a <code>{lavaan}</code> tutorial based on a method I used several times: Growth and Parallel Process Models (PPMs).</p>
<p>Most of the tutorials I have found explain only one factor (e.g., <a href="https://lavaan.ugent.be/tutorial/growth.html">the growth curve page on the <code>{lavaan}</code> website</a>) and putting two of these together can be daunting to a new <code>R</code> or <code>{lavaan}</code> user.</p>
<p>Think of this more as a tutorial of the steps needed to take when fitting growth models in <code>{lavaan}</code>, rather than a tutorial solely on either the method or the software.</p>
<p>As a quick terminology aside: I refer to growth models where 2+ factors are modeled “in parallel over time” as parallel process models (PPMs), but they are sometimes referred to differently. </p>
<h5 id="notes">NOTES:</h5>
<ol type="1">
<li><p>Being a SEM method, this assumes some familiarity with SEM, though I hope to present this in a way that is clear to as many people as possible.</p></li>
<li><p>I expect you to understand or to be able to refer to <a href="https://lavaan.ugent.be/tutorial/index.html"><code>{lavaan}</code> syntax</a> for basic syntax/interpretation.</p></li>
<li><p>Consider what I give you the nuts and bolts in how to make this work, and you should refer to other resources for more in depth interpretations.</p></li>
</ol>
<h1 id="load-packages">Load packages</h1>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://lavaan.ugent.be'>lavaan</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/jrnold/ggthemes'>ggthemes</a></span><span class='op'>)</span>
<span class='fu'>theme_set</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ggthemes/man/theme_economist.html'>theme_economist</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h1 id="simulating-data-for-demonstration">Simulating Data for Demonstration</h1>
<p>In order to complete this project, I simulated some data (n = 500). For simplicity, I actually used <code>{lavaan}</code> to make my data, but other software can do this too.  I am reserving the code for this until the end, in case you would like to know how I did that, or if you’re curious to see how closely our PPM approximates the structure of the data we made.  Specifically, I made two variables across 4 waves (growth modeling assumes time to be equally spaced).  I named the variables <code>{x1}</code> =<code>{x}</code>at time 1, <code>{x2}</code> = <code>{x}</code> at time 2, etc. &amp; <code>{y1}</code> = <code>{y}</code> at time 1, etc.</p>
<h1 id="fit-statistics">Fit statistics</h1>
<p>In SEM, goodness-of-fit testing is not free; you need degrees of freedom. Specifically, you can calculate fit on models where the highest term is <code>{x^(n-2)}</code> where <code>{n}</code> is the number of waves you have. I wanted to show a quadratic fitting process, so I included 4 waves (i.e., x^(4-2) = x^2-order models can be assessed for fit).</p>
<p>It’s good practice to have a set of fit statistcs specified <em>a priori</em> so you aren’t cherry picking good and bad results. Here’s a spread of them I’ve selected, along with ideal levels of fit (commented out).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>selected_fit_stats</span> <span class='op'>&lt;-</span>   
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"chisq.scaled"</span>,
    <span class='st'>"df.scaled"</span>, <span class='co'>## must be &gt;0 to test G.O.F.</span>
    <span class='st'>"pvalue.scaled"</span>, <span class='co'>## ideally n.s.</span>
    <span class='st'>"cfi.scaled"</span>, <span class='co'>## ideally ≥ 0.95</span>
    <span class='st'>"rmsea.scaled"</span>, <span class='co'>## ideally ≤ 0.05</span>
    <span class='st'>"rmsea.pvalue.scaled"</span>, <span class='co'>## ideally n.s.</span>
    <span class='st'>"srmr"</span> <span class='co'>## ideally &lt; 0.08</span>
    <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h1 id="steps-for-a-ppm">Steps for a PPM:</h1>
<ol type="1">
<li>Plot your data</li>
<li>Assess fit of various models for both variables (i.e., no growth, linear growth, quadratic growth, etc.).</li>
<li>Combine individual ideal models</li>
<li>Assess fit (&amp; modify syntax, typically, but that is nuanced &amp; beyond our scope)</li>
<li>Plot the predicted data &amp; compare to step 1</li>
</ol>
<h1 id="step-1.-plot-your-data">STEP 1. Plot your data</h1>
<p>This should give you a guess at what forms probably will fit. I did some work in <code>{tidyr}</code> to move the data around, then plotted in <code>{ggplot2}</code>, where we can see individual trajectories for each construct over time. I set the <code>alpha</code> parameter very low (0.2) so lines are transparent and we can get at density of distribution.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim_growth_dat</span><span class='op'>$</span><span class='va'>participant_n</span> <span class='op'>&lt;-</span> 
  <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>sim_growth_dat</span><span class='op'>)</span> <span class='co'>#add participant number</span>

<span class='va'>x_plot</span> <span class='op'>&lt;-</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='va'>sim_growth_dat</span>, 
               cols <span class='op'>=</span> <span class='va'>x1</span><span class='op'>:</span><span class='va'>x4</span>, 
               names_to <span class='op'>=</span> <span class='st'>'x'</span>,
               names_prefix <span class='op'>=</span> <span class='st'>'x'</span><span class='op'>)</span>

<span class='va'>individual_x_trajectories</span> <span class='op'>&lt;-</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>x_plot</span>, 
         <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
             y <span class='op'>=</span> <span class='va'>value</span>, 
             group <span class='op'>=</span> <span class='va'>participant_n</span>, 
             color <span class='op'>=</span> <span class='va'>participant_n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>'Observed Trajectories of x'</span>, 
       x <span class='op'>=</span> <span class='st'>'Timepoint'</span>, 
       y <span class='op'>=</span> <span class='st'>'x'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>'none'</span><span class='op'>)</span>

<span class='va'>individual_x_trajectories</span>
</code></pre>
</div>
</details>
<p><img src="growth-ppm_files/figure-html5/unnamed-chunk-6-1.png" width="624" data-distill-preview=1 /></p>
</div>
<p>You can see that the <code>{x}</code> variable is probably linearly increasing, but a very “shallow” quadratic model might fit better so we should check if it fits well. If both fit well, we will compare them with likelihood ratio tests (LRTs).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y_plot</span> <span class='op'>&lt;-</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='va'>sim_growth_dat</span>, 
               cols <span class='op'>=</span> <span class='va'>y1</span><span class='op'>:</span><span class='va'>y4</span>, 
               names_to <span class='op'>=</span> <span class='st'>'y'</span>,
               names_prefix <span class='op'>=</span> <span class='st'>'y'</span><span class='op'>)</span>

<span class='va'>individual_y_trajectories</span> <span class='op'>&lt;-</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>y_plot</span>, 
         <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>, 
             y <span class='op'>=</span> <span class='va'>value</span>, 
             group <span class='op'>=</span> <span class='va'>participant_n</span>, 
             color <span class='op'>=</span> <span class='va'>participant_n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_line</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>'Observed trajectories of y'</span>, 
       x <span class='op'>=</span> <span class='st'>'Timepoint'</span>, 
       y <span class='op'>=</span> <span class='st'>'y'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>'none'</span><span class='op'>)</span>

<span class='va'>individual_y_trajectories</span>
</code></pre>
</div>
</details>
<p><img src="growth-ppm_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>It is clear that <code>{y}</code> decreases with time on average, but there is heterogeneity (or variability) in what happens for an individual case. It looks like a either a linear or quadratic model will fit best. </p>
<p>Let’s dive in!</p>
<h1 id="step-2.-assess-fit-of-various-models">STEP 2. Assess fit of various models</h1>
<p>Time to first fit the model to an intercept-only model (i.e., no growth observed).</p>
<p>Next, we’ll look at linear growth (linear + intercept), then quadratic growth (quadratic + linear + intercept). We won’t go higher than that because we cannot assess fit with only 4 waves.</p>
<p>There are lots of nuances here, but I discuss some common choices here.</p>
<h3 id="function">Function</h3>
<p>The <code>growth()</code> call in <code>{lavaan}</code> is an easy way to specify a growth model. By default, it sets means/intercepts of observed variables to 0 and determines mean structure for latent variables.</p>
<h3 id="estimator">Estimator</h3>
<p>All data used here is continuous, so we’ll stick with maximum likelihood (<code>estimator = ML</code>) estimation, and I prefer to use the “robust” variant (<code>estimator = MLR</code>) whenever possible to account for non-normal data. </p>
<h3 id="missingness">Missingness</h3>
<p>For simplicity, there is no missingness in this data. If there were, we could do Little’s Test of Missing data and see patterns of missingness. Assuming data was missing (completely) at random and we didn’t have too much missingness, we could use Full-information Maximum Likelihood to impute missing data. </p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>int_x_mod</span> <span class='op'>&lt;-</span> 
  <span class='st'>'
iX =~ 1*x1 + 1*x2 + 1*x3 + 1*x4

  '</span>
<span class='va'>int_x_fit</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/growth.html'>growth</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='va'>int_x_mod</span>,
         estimator <span class='op'>=</span> <span class='st'>'MLR'</span>,
         data <span class='op'>=</span> <span class='va'>sim_growth_dat</span><span class='op'>)</span>

<span class='va'>int_x_fit_stats</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/fitMeasures.html'>fitmeasures</a></span><span class='op'>(</span>
    <span class='va'>int_x_fit</span>, 
    <span class='va'>selected_fit_stats</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>int_x_fit_stats</span>, <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>                          .
chisq.scaled        1192.66
df.scaled              8.00
pvalue.scaled          0.00
cfi.scaled             0.02
rmsea.scaled           0.54
rmsea.pvalue.scaled    0.00
srmr                   0.63</code></pre>
</div>
<p>The no growth model for <code>{x}</code> does not fit well by any measure. So we’ll move on.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>int_y_mod</span> <span class='op'>&lt;-</span> 
  <span class='st'>'
iY =~ 1*y1 + 1*y2 + 1*y3 + 1*y4
  '</span>
<span class='va'>int_y_fit</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/growth.html'>growth</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='va'>int_y_mod</span>, 
         estimator <span class='op'>=</span> <span class='st'>'MLR'</span>,
         data <span class='op'>=</span> <span class='va'>sim_growth_dat</span><span class='op'>)</span>

<span class='va'>int_y_fit_stats</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/fitMeasures.html'>fitmeasures</a></span><span class='op'>(</span>
    <span class='va'>int_y_fit</span>, 
    <span class='va'>selected_fit_stats</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>int_y_fit_stats</span>, <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>                          .
chisq.scaled        3136.54
df.scaled              8.00
pvalue.scaled          0.00
cfi.scaled             0.00
rmsea.scaled           0.88
rmsea.pvalue.scaled    0.00
srmr                   0.98</code></pre>
</div>
<p>The no growth model for <code>{y}</code> does not fit well by any measure either.  Next, we will check how well a linear-only growth model fits for the <code>{x}</code> &amp; <code>{y}</code> variables</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>linear_x_mod</span> <span class='op'>&lt;-</span> 
  <span class='st'>'
iX =~ 1*x1 + 1*x2 + 1*x3 + 1*x4
sX =~ 0*x1 + 1*x2 + 2*x3 + 3*x4

  '</span>
<span class='va'>linear_x_fit</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/growth.html'>growth</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='va'>linear_x_mod</span>,
         estimator <span class='op'>=</span> <span class='st'>'MLR'</span>,
         data <span class='op'>=</span> <span class='va'>sim_growth_dat</span><span class='op'>)</span>

<span class='va'>linear_x_fit_stats</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/fitMeasures.html'>fitmeasures</a></span><span class='op'>(</span><span class='va'>linear_x_fit</span>, 
              <span class='va'>selected_fit_stats</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>linear_x_fit_stats</span>, <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>                       .
chisq.scaled        4.03
df.scaled           5.00
pvalue.scaled       0.54
cfi.scaled          1.00
rmsea.scaled        0.00
rmsea.pvalue.scaled 0.92
srmr                0.02</code></pre>
</div>
<p>The linear growth model for <code>{x}</code> fits well by all measures. This is what we expected based on the graph of observed data. We should test quadratic models for fit, though.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>linear_y_mod</span> <span class='op'>&lt;-</span> 
  <span class='st'>'
iY =~ 1*y1 + 1*y2 + 1*y3 + 1*y4
sY =~ 0*y1 + 1*y2 + 2*y3 + 3*y4
  '</span>
<span class='va'>linear_y_fit</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/growth.html'>growth</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='va'>linear_y_mod</span>,
         estimator <span class='op'>=</span> <span class='st'>'MLR'</span>,
         data <span class='op'>=</span> <span class='va'>sim_growth_dat</span><span class='op'>)</span>

<span class='va'>linear_y_fit_stats</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/fitMeasures.html'>fitmeasures</a></span><span class='op'>(</span>
    <span class='va'>linear_y_fit</span>, 
    <span class='va'>selected_fit_stats</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>linear_y_fit_stats</span>, <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>                         .
chisq.scaled        842.85
df.scaled             5.00
pvalue.scaled         0.00
cfi.scaled            0.61
rmsea.scaled          0.58
rmsea.pvalue.scaled   0.00
srmr                  0.55</code></pre>
</div>
<p>Looks like the linear <code>{y}</code> is inadequate across all measures. </p>
<h5 id="note">NOTE:</h5>
<p>Quadratic terms represent the average rate of change of the slope across waves. This is synonymous with acceleration in other disciplines, though this terminology is not often used and ‘quadratic growth’ is typically preferred in SEM.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>quad_x_mod</span> <span class='op'>&lt;-</span> 
  <span class='st'>'
iX =~ 1*x1 + 1*x2 + 1*x3 + 1*x4
sX =~ 0*x1 + 1*x2 + 2*x3 + 3*x4
qX =~ 0*x1 + 1*x2 + 4*x3 + 9*x4


  '</span>
<span class='va'>quad_x_fit</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/growth.html'>growth</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='va'>quad_x_mod</span>, 
         estimator <span class='op'>=</span> <span class='st'>'MLR'</span>,
         data <span class='op'>=</span> <span class='va'>sim_growth_dat</span><span class='op'>)</span>

<span class='va'>quad_x_fit_stats</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/fitMeasures.html'>fitmeasures</a></span><span class='op'>(</span><span class='va'>quad_x_fit</span>, 
              <span class='va'>selected_fit_stats</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>quad_x_fit_stats</span>, <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>       chisq.scaled           df.scaled       pvalue.scaled 
               0.02                1.00                0.89 
         cfi.scaled        rmsea.scaled rmsea.pvalue.scaled 
               1.00                0.00                0.94 
               srmr 
               0.00 </code></pre>
</div>
<p>Here we have an interesting issue, as <code>{x}</code> fits fairly well to both a linear &amp; a quadratic model, but we have a Heywood case, specifically the estimated observed variable variance is negative. Let’s inspect </p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/lavInspect.html'>lavInspect</a></span><span class='op'>(</span><span class='va'>quad_x_fit</span>, <span class='st'>"est"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>theta</span>
</code></pre>
</div>
</details>
<pre><code>   x1     x2     x3     x4    
x1  1.171                     
x2  0.000  0.718              
x3  0.000  0.000  1.213       
x4  0.000  0.000  0.000 -0.064</code></pre>
</div>
<p>Our <code>{x4}</code> variable has a negative estimate for the observed variable’s variance. This is a problem, and indicates the model may not represent the data well. There are ways to use parameter constraints to see if the fit is good if we “force” a change to this parameter, but that’s beyond our scope today.</p>
<p>For teaching purposes, we’ll pretend we didn’t have a Heywood case to do the next step.</p>
<p>When you have two well-fitting nested models (in our case linear &amp; quadratic models), we can compare the fit formally with Likelihood Ratio Tests (LRTs). The null hypothesis is essentially that there is no difference in the variance explained by the two models. Parsimony is preferred in a situation where the variance explained is equivalent. </p>
<h5 id="note-1">NOTE:</h5>
<p>Some will say this test is only valid if the models have n.s. p-values and there are no Heywood cases.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/lavTestLRT.html'>lavTestLRT</a></span><span class='op'>(</span><span class='va'>linear_x_fit</span>, <span class='va'>quad_x_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Scaled Chi-Squared Difference Test (method = &quot;satorra.bentler.2001&quot;)

lavaan NOTE:
    The &quot;Chisq&quot; column contains standard test statistics, not the
    robust test that should be reported per model. A robust difference
    test is a function of two standard (not robust) statistics.
 
             Df    AIC    BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)
quad_x_fit    1 7570.4 7625.2 0.0200                              
linear_x_fit  5 7566.4 7604.3 4.0675     4.0026       4     0.4056</code></pre>
</div>
<p>Here, a non-significant p-value tells us that the linear model is preferred here. </p>
<p>Now onto the quadratic <code>{y}</code> model.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>quad_y_mod</span> <span class='op'>&lt;-</span> 
  <span class='st'>'
iY =~ 1*y1 + 1*y2 + 1*y3 + 1*y4
sY =~ 0*y1 + 1*y2 + 2*y3 + 3*y4
qY =~ 0*y1 + 1*y2 + 4*y3 + 9*y4


  '</span>
<span class='va'>quad_y_fit</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/growth.html'>growth</a></span><span class='op'>(</span>
    model <span class='op'>=</span> <span class='va'>quad_y_mod</span>, 
    estimator <span class='op'>=</span> <span class='st'>'MLR'</span>,
    data <span class='op'>=</span> <span class='va'>sim_growth_dat</span><span class='op'>)</span>

<span class='va'>quad_y_fit_stats</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/fitMeasures.html'>fitmeasures</a></span><span class='op'>(</span>
    <span class='va'>quad_y_fit</span>, 
    <span class='va'>selected_fit_stats</span>
    <span class='op'>)</span>

<span class='va'>quad_y_fit_stats</span>
</code></pre>
</div>
</details>
<pre><code>       chisq.scaled           df.scaled       pvalue.scaled 
              0.190               1.000               0.663 
         cfi.scaled        rmsea.scaled rmsea.pvalue.scaled 
              1.000               0.000               0.813 
               srmr 
              0.001 </code></pre>
</div>
<p>It’s clear that only the <code>{x}</code> linear model was a good one by all fit statistics. We could actually easily see this earlier in Step 1, but it is good that we checked. </p>
<p>When using real—world data this may or may not be the case; I simulated this data specifically to be clean linear and quadratic models for <code>{x}</code> &amp; <code>{y}</code> respectively. </p>
<h1 id="step-3.-building-the-ppm">STEP 3. Building the PPM</h1>
<p>Now that we are fairly confident in functional forms, let’s model them together. </p>
<h5 id="note-2">NOTE:</h5>
<p>For simplicity we are <em>not</em> specifying conditional models which make future growth terms conditional upon earlier growth terms. The distinction between the two is subtle and deserves its own conversation later. For now, just assume growth terms are simply correlated, rather than causally linked.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>full_model</span> <span class='op'>&lt;-</span> 
  <span class='st'>'
## intercept &amp; slope growth terms for X
iX =~ 1*x1 + 1*x2 + 1*x3 + 1*x4
sX =~ 0*x1 + 1*x2 + 2*x3 + 3*x4

## intercept, slope, &amp; quadratic terms for Y
iY =~ 1*y1 + 1*y2 + 1*y3 + 1*y4
sY =~ 0*y1 + 1*y2 + 2*y3 + 3*y4
qY =~ 0*y1 + 1*y2 + 4*y3 + 9*y4

## regress growth terms on predictor
qY + iY + sX + iX ~ predictor
sY ~ a1*predictor

## regress outcome on growth terms
outcome ~ iX + sX + iY + b1*sY + qY

## testing indirect effect 
## predictor --&gt; sY --&gt; outcome

predictor_sY_outcome:=a1*b1
  '</span>

<span class='va'>full_fit</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/growth.html'>growth</a></span><span class='op'>(</span>
    model <span class='op'>=</span> <span class='va'>full_model</span>, 
    estimator <span class='op'>=</span> <span class='st'>'MLR'</span>,
    data <span class='op'>=</span> <span class='va'>sim_growth_dat</span><span class='op'>)</span>

<span class='va'>full_fit_stats</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/fitMeasures.html'>fitmeasures</a></span><span class='op'>(</span>
    <span class='va'>full_fit</span>, 
    <span class='va'>selected_fit_stats</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>full_fit_stats</span>,<span class='fl'>2</span><span class='op'>)</span> 
</code></pre>
</div>
</details>
<pre><code>       chisq.scaled           df.scaled       pvalue.scaled 
              28.23               34.00                0.75 
         cfi.scaled        rmsea.scaled rmsea.pvalue.scaled 
               1.00                0.00                1.00 
               srmr 
               0.03 </code></pre>
</div>
<h1 id="full-model-fit">Full Model Fit</h1>
<p>We can see that this model fits well across all fit statistics chosen. This model is deemed acceptable and we can now interpret the model results</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>full_fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>lavaan 0.6-9 ended normally after 65 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        29
                                                      
  Number of observations                           500
                                                      
Model Test User Model:
                                               Standard      Robust
  Test Statistic                                 28.456      28.233
  Degrees of freedom                                 34          34
  P-value (Chi-square)                            0.736       0.746
  Scaling correction factor                                   1.008
       Yuan-Bentler correction (Mplus variant)                     

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  iX =~                                               
    x1                1.000                           
    x2                1.000                           
    x3                1.000                           
    x4                1.000                           
  sX =~                                               
    x1                0.000                           
    x2                1.000                           
    x3                2.000                           
    x4                3.000                           
  iY =~                                               
    y1                1.000                           
    y2                1.000                           
    y3                1.000                           
    y4                1.000                           
  sY =~                                               
    y1                0.000                           
    y2                1.000                           
    y3                2.000                           
    y4                3.000                           
  qY =~                                               
    y1                0.000                           
    y2                1.000                           
    y3                4.000                           
    y4                9.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  qY ~                                                
    predictor         0.041    0.048    0.850    0.395
  iY ~                                                
    predictor         0.034    0.060    0.564    0.573
  sX ~                                                
    predictor         0.008    0.051    0.161    0.872
  iX ~                                                
    predictor         0.067    0.060    1.119    0.263
  sY ~                                                
    predictor (a1)    2.022    0.079   25.545    0.000
  outcome ~                                           
    iX                1.994    0.145   13.755    0.000
    sX               -0.017    0.146   -0.115    0.908
    iY               -0.028    0.186   -0.149    0.881
    sY        (b1)    2.973    0.104   28.596    0.000
    qY               -0.242    0.161   -1.510    0.131

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.000                           
   .x2                0.000                           
   .x3                0.000                           
   .x4                0.000                           
   .y1                0.000                           
   .y2                0.000                           
   .y3                0.000                           
   .y4                0.000                           
   .outcome           0.000                           
   .iX                1.976    0.059   33.700    0.000
   .sX                0.991    0.051   19.350    0.000
   .iY                0.031    0.061    0.508    0.611
   .sY               -1.153    0.082  -14.019    0.000
   .qY               -1.548    0.048  -32.151    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                1.067    0.099   10.777    0.000
   .x2                0.885    0.069   12.924    0.000
   .x3                0.983    0.104    9.492    0.000
   .x4                1.113    0.197    5.646    0.000
   .y1                0.961    0.107    8.991    0.000
   .y2                0.868    0.083   10.470    0.000
   .y3                0.996    0.179    5.557    0.000
   .y4                2.467    0.949    2.601    0.009
   .outcome           0.814    0.927    0.878    0.380
   .iX                1.043    0.100   10.444    0.000
   .sX                1.094    0.076   14.393    0.000
   .iY                1.040    0.108    9.595    0.000
   .sY                1.131    0.125    9.078    0.000
   .qY                0.927    0.068   13.684    0.000

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    predctr_sY_tcm    6.011    0.159   37.874    0.000</code></pre>
</div>
<h1 id="interpretation">Interpretation</h1>
<p>I am going to trust you understand how to read <code>{lavaan}</code> here, so I’m not going to walk through this line by line. The headlines are <code>{iX}</code> &amp; <code>{sY}</code> significantly predict <code>{outcome}</code>, with the latter predicting it to a much larger degree than the former. </p>
<p>This means baseline levels of <code>{x}</code> predict outcome, as does the linear rate of change of <code>{y}</code>, both positively such that higher levels of initial <code>{x}</code> or faster rates of change in <code>{y}</code> lead to higher levels of <code>{outcome}</code>.</p>
<p>In our example, I included a time-invariant covariate <code>{predictor}</code>. Since <code>{predictor}</code> significantly predicted <code>{sY}</code> and <code>{sY}</code> predicted <code>{outcome}</code>, we would want to look for mediation. You may trust the estimate given by simply the product of each coefficient and it’s significance test, but it is better to rely on other methods to test indirect effects.</p>
<h1 id="bootstrapping">Bootstrapping</h1>
<p>Bootstrapping is a resampling method (with replacement) that is appreciated for building confidence intervals around parameter estimates of indirect effects, at least in part, because they do not make distributional assumptions about the indirect effect. This creates a more reliable test than standard significance tests. A quick Google Scholar search can inform you on this topic more deeply than this post, but I used this to test the indirect effects using 5000 simulated data sets.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>final_fit_boot</span><span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/growth.html'>growth</a></span><span class='op'>(</span><span class='va'>full_fit</span>, 
         data <span class='op'>=</span> <span class='va'>sim_growth_dat</span>, 
         estimator <span class='op'>=</span> <span class='st'>"ML"</span>,
         meanstructure <span class='op'>=</span> <span class='cn'>T</span>,
         se <span class='op'>=</span> <span class='st'>"bootstrap"</span>,
         bootstrap <span class='op'>=</span> <span class='fl'>100</span>, <span class='co'># ~5000 better</span>
         parallel <span class='op'>=</span> <span class='st'>"multicore"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/parameterEstimates.html'>parameterEstimates</a></span><span class='op'>(</span>
  <span class='va'>final_fit_boot</span>,
  level <span class='op'>=</span> <span class='fl'>.95</span>,
  boot.ci.type <span class='op'>=</span> <span class='st'>"bca.simple"</span>,
  stand <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>61</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>9</span>,<span class='fl'>10</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code>                  label   est ci.lower ci.upper
61 predictor_sY_outcome 6.011    5.707    6.355</code></pre>
</div>
<p>Since this is a tutorial, I set our model to only run 100 times for speed, but you’d likely want to set <code>bootstrap = 5000</code> for better practice. </p>
<p>Furthermore, looking at the 95% confidence intervals, we find the same result as we did regarding the indirect effect as without bootstrapping. These are the results I trust more, especially since we used <code>bca.simple</code>. </p>
<p>Most likely this is what we wanted to do with this model (at least in my field). Assess if a predictor influences growth in a construct, then see if there is an indirect effect (and quanitify its magnitude).</p>
<h5 id="note-3">NOTE:</h5>
<p>I made it so only the label, unstandardized estimate and confidence intervals showed up with the <code>[61,c(4,5,9,10)]</code> portion of code, but you should <em>not</em> trust the p-values from this parameterEstimates() if you go with <em>anything but the default</em> (i.e., <code>boot.ci.type = norm</code>).  This is because the p-value is built assuming a normal distribution; this eliminates some of the benefits of bootstrapping gained by <code>bca.simple</code> and other methods, but gives you a p-value, which matters a lot to some.</p>
<h1 id="plotting">Plotting</h1>
<p>We can plot the growth of these traits, as well with <code>{ggplot2}</code>, which helps verify you did this correctly. I won’t go into it here, but these plots can be modified with facet wrapping and other grouping/coloring methods to see how different groups have different slopes, for example. </p>
<p>First we extract factor scores &amp; save this as a data frame, then we can plot. For a linear model, this is pretty simple:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>plot_dat</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/lavPredict.html'>lavPredict</a></span><span class='op'>(</span><span class='va'>full_fit</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>plot_dat</span><span class='op'>$</span><span class='va'>participant_n</span> <span class='op'>&lt;-</span> 
  <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>plot_dat</span><span class='op'>)</span>

<span class='va'>plot_dat</span><span class='op'>$</span><span class='va'>predictor</span> <span class='op'>&lt;-</span> 
  <span class='va'>sim_growth_dat</span><span class='op'>$</span><span class='va'>predictor</span>

<span class='va'>predicted_x_trajectories</span> <span class='op'>&lt;-</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>plot_dat</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>
    name <span class='op'>=</span> <span class='st'>"Timepoint"</span>,
    limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>3</span><span class='op'>)</span>,
    breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span>,
    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'1'</span>, <span class='st'>'2'</span>, <span class='st'>'3'</span>, <span class='st'>'4'</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>
    name <span class='op'>=</span> <span class='st'>"x"</span>, 
    limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>,<span class='fl'>15</span><span class='op'>)</span>
    <span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_abline</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>plot_dat</span>, 
    mapping <span class='op'>=</span> 
      <span class='fu'>aes</span><span class='op'>(</span>slope<span class='op'>=</span><span class='va'>sX</span>, 
          intercept<span class='op'>=</span><span class='va'>iX</span>, 
          color <span class='op'>=</span> <span class='va'>participant_n</span><span class='op'>)</span>,
    alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>'Predicted trajectories of x'</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>'none'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>We can compare those to the observed trajectories (top) to the predicted trajectories (bottom) with <code>{gridExtra}</code> to merge our plots.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>gridExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html'>grid.arrange</a></span><span class='op'>(</span>
  <span class='va'>individual_x_trajectories</span>, 
  <span class='va'>predicted_x_trajectories</span>, 
  ncol <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="growth-ppm_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<p>For a quadratic model, this is more challenging, but here’s some code to do it:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>plot_dat</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/lavPredict.html'>lavPredict</a></span><span class='op'>(</span><span class='va'>full_fit</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>plot_dat</span><span class='op'>$</span><span class='va'>participant_n</span> <span class='op'>&lt;-</span> 
  <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>plot_dat</span><span class='op'>)</span>

<span class='va'>plot_dat</span><span class='op'>$</span><span class='va'>predictor</span> <span class='op'>&lt;-</span>
  <span class='va'>sim_growth_dat</span><span class='op'>$</span><span class='va'>predictor</span>

<span class='va'>qY</span> <span class='op'>&lt;-</span> <span class='va'>plot_dat</span><span class='op'>$</span><span class='va'>qY</span>
<span class='va'>sY</span> <span class='op'>&lt;-</span> <span class='va'>plot_dat</span><span class='op'>$</span><span class='va'>sY</span>
<span class='va'>iY</span> <span class='op'>&lt;-</span> <span class='va'>plot_dat</span><span class='op'>$</span><span class='va'>iY</span>

<span class='va'>test</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>{</span><span class='va'>qY</span><span class='op'>*</span><span class='va'>y</span> <span class='op'>^</span> <span class='fl'>2</span> <span class='op'>+</span> <span class='va'>sY</span><span class='op'>*</span><span class='va'>y</span> <span class='op'>+</span> <span class='va'>iY</span><span class='op'>}</span>


<span class='va'>plot_dat_2</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>`T1` <span class='op'>=</span> <span class='fu'>test</span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>, 
             `T2` <span class='op'>=</span> <span class='fu'>test</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>, 
             `T3` <span class='op'>=</span> <span class='fu'>test</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>, 
             `T4` <span class='op'>=</span> <span class='fu'>test</span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span>, 
             row.names <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>plot_dat</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>plot_dat</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'1'</span>, <span class='st'>'2'</span>, <span class='st'>'3'</span>, <span class='st'>'4'</span><span class='op'>)</span> 

<span class='va'>test0</span> <span class='op'>&lt;-</span> <span class='fu'>test</span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>
<span class='va'>test1</span> <span class='op'>&lt;-</span> <span class='fu'>test</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>test2</span> <span class='op'>&lt;-</span> <span class='fu'>test</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span>
<span class='va'>test3</span> <span class='op'>&lt;-</span> <span class='fu'>test</span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span>

<span class='va'>Y_df</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>test0</span>, 
    <span class='va'>test1</span>, 
    <span class='va'>test2</span>, 
    <span class='va'>test3</span><span class='op'>)</span>

<span class='va'>df_long_wave</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>500</span><span class='op'>)</span>, 
    <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>500</span><span class='op'>)</span>,
    <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>500</span><span class='op'>)</span>, 
    <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>500</span><span class='op'>)</span>
    <span class='op'>)</span>


<span class='va'>plot_dat_2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  participant_n <span class='op'>=</span> 
      <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>500</span>,<span class='fl'>4</span><span class='op'>)</span>, 
  Timepoint <span class='op'>=</span> 
    <span class='va'>df_long_wave</span>,
  y <span class='op'>=</span> <span class='va'>Y_df</span><span class='op'>)</span>

<span class='va'>predicted_y_trajectories</span> <span class='op'>&lt;-</span> 
  <span class='va'>plot_dat_2</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span>
    <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Timepoint</span>, 
        y <span class='op'>=</span> <span class='va'>y</span>, 
        group <span class='op'>=</span> <span class='va'>participant_n</span>, 
        color <span class='op'>=</span> <span class='va'>participant_n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
 <span class='fu'>geom_line</span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>,
           method <span class='op'>=</span> <span class='st'>"lm"</span>, 
           se <span class='op'>=</span> <span class='cn'>F</span>, 
           alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span><span class='st'>'Predicted trajectories of y'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>'none'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Again, can compare those to the observed trajectories (top) to the predicted trajectories (bottom).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>gridExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html'>grid.arrange</a></span><span class='op'>(</span>
  <span class='va'>individual_y_trajectories</span>, 
  <span class='va'>predicted_y_trajectories</span>, 
  ncol <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="growth-ppm_files/figure-html5/unnamed-chunk-22-1.png" width="624" /></p>
</div>
<h1 id="next-steps">Next Steps:</h1>
<p>If you were to be working on this, I would work further to make the model more parsimoneous, as well as seeing if alternate modifications would increase model fit. Ways to do this include, but are not limited to, constraining residuals, assessing the role of the predictor on the observed vs. manifest model, making the growth terms conditional upon earlier terms, etc.</p>
<h1 id="looking-at-the-simulation-call">Looking at the simulation call</h1>
<p>Here is the exact simulation call I did in case anyone is curious. I wanted the data to be interesting, so I made sure to set some things (e.g., variances, latent means/intercepts, relationships between variables, etc.)</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>growth_mod</span> <span class='op'>&lt;-</span> 
  <span class='st'>'

## intercept &amp; slope growth terms for X
iX =~ 1*x1 + 1*x2 + 1*x3 + 1*x4
sX =~ 0*x1 + 1*x2 + 2*x3 + 3*x4

## intercept, slope, &amp; quadratic terms for Y
iY =~ 1*y1 + 1*y2 + 1*y3 + 1*y4
sY =~ 0*y1 + 1*y2 + 2*y3 + 3*y4
qY =~ 0*y1 + 1*y2 + 4*y3 + 9*y4

## set variances 

y4 ~~ 2*y4
x4 ~~ 1*x4

## set latent means/intercepts
iX ~ 2*1
sX ~ 1*1
sY ~ -1*1
qY ~ -1.5*1

sY ~ 2*predictor

outcome ~ 2*iX + 3*sY 
  '</span>
</code></pre>
</div>
</details>
</div>
<p>In the data I simulated, Variable <code>{x}</code> is changing linearly over time and variable <code>{y}</code> is changing quadratically, which his what we found.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim_growth_dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/simulateData.html'>simulateData</a></span><span class='op'>(</span>
  model <span class='op'>=</span> <span class='va'>growth_mod</span>, 
  model.type <span class='op'>=</span> <span class='st'>"growth"</span>, 
  seed <span class='op'>=</span> <span class='fl'>82020</span>, 
  orthogonal <span class='op'>=</span> <span class='cn'>F</span>,
  auto.cov.y <span class='op'>=</span> <span class='cn'>T</span>, 
  auto.var <span class='op'>=</span> <span class='cn'>T</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
