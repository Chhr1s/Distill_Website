<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>APA 2021 Supplemental Material</title>

  <meta property="description" itemprop="description" content="Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, &amp; Keith Zvoch"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-08-03"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-08-03"/>
  <meta name="article:author" content="Christopher M. Loan"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="APA 2021 Supplemental Material"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, &amp; Keith Zvoch"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="APA 2021 Supplemental Material"/>
  <meta property="twitter:description" content="Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, &amp; Keith Zvoch"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output","draft"]}},"value":[{"type":"character","attributes":{},"value":["APA 2021 Supplemental Material"]},{"type":"character","attributes":{},"value":["Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, & Keith Zvoch"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Christopher M. Loan"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["2021-08-03"]},{"type":"character","attributes":{},"value":["Collaboration","Conference","Machine Learning","Multi-Level Modeling","MLM","Plotting","Simulated Data","Tutorial"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","code_folding","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["show code"]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"logical","attributes":{},"value":[true]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["apa-2021_files/anchor-4.2.2/anchor.min.js","apa-2021_files/bowser-1.9.3/bowser.min.js","apa-2021_files/distill-2.2.21/template.v2.js","apa-2021_files/figure-html5/figure 1-1.png","apa-2021_files/figure-html5/figure 2-1.png","apa-2021_files/figure-html5/plot ranef 1-1.png","apa-2021_files/figure-html5/plot tree 1-1.pdf","apa-2021_files/figure-html5/plot tree 1-1.png","apa-2021_files/figure-html5/plot tree 1-2.png","apa-2021_files/figure-html5/plot tree 1, l-page-1.png","apa-2021_files/figure-html5/plot tree 2-1.pdf","apa-2021_files/figure-html5/plot tree 2-1.png","apa-2021_files/figure-html5/plot tree 3-1.pdf","apa-2021_files/figure-html5/plot tree 3-1.png","apa-2021_files/figure-html5/plot tree 4-1.png","apa-2021_files/figure-html5/unnamed-chunk-1-1.pdf","apa-2021_files/figure-html5/unnamed-chunk-1-1.png","apa-2021_files/figure-html5/unnamed-chunk-1-2.png","apa-2021_files/figure-html5/unnamed-chunk-2-1.png","apa-2021_files/figure-html5/unnamed-chunk-2-2.png","apa-2021_files/figure-html5/unnamed-chunk-3-1.png","apa-2021_files/figure-html5/unnamed-chunk-3-2.png","apa-2021_files/header-attrs-2.6/header-attrs.js","apa-2021_files/jquery-1.11.3/jquery.min.js","apa-2021_files/popper-2.6.0/popper.min.js","apa-2021_files/tippy-6.2.7/tippy-bundle.umd.min.js","apa-2021_files/tippy-6.2.7/tippy-light-border.css","apa-2021_files/tippy-6.2.7/tippy.css","apa-2021_files/tippy-6.2.7/tippy.umd.min.js","apa-2021_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="apa-2021_files/header-attrs-2.6/header-attrs.js"></script>
  <script src="apa-2021_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="apa-2021_files/popper-2.6.0/popper.min.js"></script>
  <link href="apa-2021_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="apa-2021_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="apa-2021_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="apa-2021_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="apa-2021_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="apa-2021_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="apa-2021_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"APA 2021 Supplemental Material","description":"Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, & Keith Zvoch","authors":[{"author":"Christopher M. Loan","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-08-03T00:00:00.000-07:00","citationText":"Loan, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>APA 2021 Supplemental Material</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">Collaboration</div>
<div class="dt=tag">Conference</div>
<div class="dt=tag">Machine Learning</div>
<div class="dt=tag">Multi-Level Modeling</div>
<div class="dt=tag">MLM</div>
<div class="dt=tag">Plotting</div>
<div class="dt=tag">Simulated Data</div>
<div class="dt=tag">Tutorial</div>
</div>
<!--/radix_placeholder_categories-->
<p>Supplmental Material for the Application of Generalized Linear Mixed-Effects Model Regression Trees with Multi-Modal Data poster presented at APA 2021, co-authored with Matthew C. Graham, Edwin M. Zorilla, Idalis Villanueva Alarcon, Jenefer Husman, &amp; Keith Zvoch</p>
</div>

<div class="d-byline">
  Christopher M. Loan true 
  
<br/>2021-08-03
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#background">Background</a>
<ul>
<li><a href="#load-libraries">load libraries</a></li>
<li><a href="#simulating-data">simulating data</a></li>
</ul></li>
<li><a href="#fitting-glmm-trees-via-glmertree">Fitting GLMM Trees via <code>{glmertree}</code></a>
<ul>
<li><a href="#model-1-fully-exploratory">Model 1: Fully Exploratory</a>
<ul>
<li><a href="#add-hyperparameters">Add hyperparameters</a></li>
<li><a href="#add-fixed-effects">Add Fixed Effects</a></li>
</ul></li>
</ul></li>
<li><a href="#mlms-via-lme4">MLMs via <code>{lme4}</code></a></li>
<li><a href="#references-recommended-reading">References &amp; Recommended Reading</a></li>
</ul>
</nav>
</div>
<p>The purpose of these supplemental materials is to walk users through using the <code>{glmertree}</code> package and provide references/supplemental reading for our poster. Refer to the Table of Contents (or scroll down) if you’re just here for references.</p>
<p>For readability, code is included but can be hidden by clicking <code>show code</code></p>
<p>Everything will be done with <code>{tidyverse}</code> functions and the<code>{glmertree}</code> package. I’ll compare some <code>{glmertree}</code> results to <code>{lme4}</code>, but this is loaded via <code>{glmertree}</code>. I’ll try and use the <code>::</code> operator to namespace functions that aren’t from the aforementioned packages. That way you know what packages call any other function I use. Some visualizations will use <code>{ggparty}</code> to plot the GLMM trees, but when possible, I will default to base plotting for simplicity. Keep an eye out on my blog for a full <code>{ggparty}</code> tutorial in the future.</p>
<h1 id="background">Background</h1>
<h2 id="load-libraries">load libraries</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>glmertree</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/martin-borkovec/ggparty'>ggparty</a></span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h2 id="simulating-data">simulating data</h2>
<p>In a perfect world, I’d be able to share the data with you and use the same data used on the poster without anything bad happening; however, we have data privacy for a reason. I still want to show you how to specify these models, and I want you to have the option to follow along. If you don’t care about the simulation and just want to see model specification: Keep reading—you’re in the right place!</p>
<p>To see how the simulation occurs and/or follow along, check out <a href="www.christopherloan.com/blog/simulating-2-level-data-for-apa-2021-supplemental/">another blog post of mine</a> that provides you with the function and describes data explored with it.</p>
<p>The short of it: I simulated N = 1065 cases — the same number of as the APA 2021 poster. However, I did not simulate random effects for items across participants. This simplifies the cross-classified design to be a simple two-level design that has n = 71 level 2 units, each with n = 15 level 1 units. Each level 2 unit has an outcome (<code>outcome</code>), two variables that are related to the outcome (<code>x</code> and <code>z</code>), and a variable that is <em>not</em> associated with the outcome (<code>w</code>).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>sim_dat</span> <span class='op'>&lt;-</span> 
  <span class='fu'>simulate_interaction_w_2_levels</span><span class='op'>(</span>
    n <span class='op'>=</span> <span class='fl'>15</span>, <span class='co'>## number level 1 units at each level 2</span>
    j <span class='op'>=</span> <span class='fl'>71</span>, <span class='co'>## number level 2 units</span>
    intercept_lv1 <span class='op'>=</span> <span class='fl'>4.25</span>, <span class='co'>## intercept at level 1</span>
    main_x <span class='op'>=</span> <span class='fl'>1.25</span>, <span class='co'>## main effect of x</span>
    main_z <span class='op'>=</span> <span class='fl'>2.00</span>, <span class='co'>## main effect of z</span>
    interaction <span class='op'>=</span> <span class='fl'>0.75</span>, <span class='co'>## interaction of x and z</span>
    residual_var_sd_lv1 <span class='op'>=</span> <span class='fl'>2.00</span>, <span class='co'>## standard deviation of residuals at level 1</span>
    random_int_mean_lv2 <span class='op'>=</span> <span class='fl'>0</span>, <span class='co'>## mean of random intercept at level 2</span>
    random_int_sd_lv2 <span class='op'>=</span> <span class='fl'>1.00</span>, <span class='co'>## standard deviation of random intercept at level 2,</span>
    start_seed <span class='op'>=</span> <span class='fl'>123</span> <span class='co'>## ensure you can reproduce </span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>tibble</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Put formally, we’re simulating:</p>
<p><span class="math display">\[
\begin{aligned}
  \operatorname{outcome}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=\alpha_{j[i]} + \beta_{1}(\operatorname{x}) + \beta_{2}(\operatorname{z}) + \beta_{3}(\operatorname{w}) + \beta_{4}(\operatorname{x} \times \operatorname{z}) \\
    \alpha_{j}  &amp;\sim N \left(\mu_{\alpha_{j}}, \sigma^2_{\alpha_{j}} \right)
    \text{, for id j = 1,} \dots \text{,J}
\end{aligned}
\]</span> where</p>
<p><span class="math display">\[\mu = 4.25\]</span> <span class="math display">\[\sigma = 2.00\]</span> <span class="math display">\[\beta_{1} = 1.25\]</span> <span class="math display">\[\beta_{2} = 2.00\]</span> <span class="math display">\[\beta_{3} = 0\]</span> <span class="math display">\[\beta_{4} = 0.75\]</span> <span class="math display">\[J = 71\]</span> <span class="math display">\[\mu_{\alpha_{j}} = 0\]</span> <span class="math display">\[\sigma_{\alpha_{j}}= 1.00\]</span></p>
<h1 id="fitting-glmm-trees-via-glmertree">Fitting GLMM Trees via <code>{glmertree}</code></h1>
<p>Specifying models with <code>{glmertree}</code> is similar to <code>{lme4}</code>. However, rather than <em>adding</em> random effects, you specify the model as follows: <code>forumla = outcome ~ fixed effects | random effects | splitting variables</code>.</p>
<p>A second consideration when fitting generalized mixed effects regression (GLMM) trees is the model’s use of parameter instability tests; therefore, we need to account for cluster covariances in this process, so you want to specify the <code>id</code> variable to the <code>cluster = id</code> argument as well as in the specified formula.</p>
<h2 id="model-1-fully-exploratory">Model 1: Fully Exploratory</h2>
<p>Let’s run a very exploratory model here. This is everything but the kitchen sink: an intercept-only model, with random intercept for each level 2 unit, and allowing splits to be made by any of the variables in the data.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_1</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/glmertree/man/glmertree.html'>lmertree</a></span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_dat</span>, 
    formula <span class='op'>=</span> 
      <span class='va'>outcome</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>|</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>z</span> <span class='op'>+</span> <span class='va'>w</span>, 
    cluster <span class='op'>=</span> <span class='va'>id</span>, 
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<p>Let’s look at plotted results first. Here are the random effects, presented as a caterpillar plot</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>tree_1</span>, which <span class='op'>=</span> <span class='st'>'ranef'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>$id</code></pre>
<p><img src="apa-2021_files/figure-html5/plot%20ranef%201-1.png" width="624" /></p>
</div>
<p>Here is the model presented as a decision tree. With the number of splits we observe here, there is too much information to be very informative about individual nodes (there was actually so much information that I had to use another package <code>{ggparty}</code> to render the plot on this website in a more careful way than the default <code>plot(tree_1, which = 'tree')</code> method. We can see, however, that the model is identifying ranges of <code>z</code> and <code>x</code> that have different intercepts. The model is never presenting <code>w</code> as a variable influencing splitting when there is so much more heterogeneity in levels of <code>z</code> and <code>x</code>. So that’s good!</p>
<div class="layout-chunk" data-layout="l-screen">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot(tree_1, which = 'tree')</span>
<span class='va'>significance_level</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>p_value</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>p_value</span> <span class='op'>&lt;</span> <span class='fl'>0.001</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"p_value &lt; 0.001"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>p_value</span> <span class='op'>&lt;</span> <span class='fl'>0.01</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"p_value &lt; 0.01"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>p_value</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"p_value &lt; 0.05"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'>else</span> <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='st'>""</span><span class='op'>)</span><span class='op'>}</span>


<span class='fu'>ggparty</span><span class='op'>(</span><span class='va'>tree_1</span><span class='op'>$</span><span class='va'>tree</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_edge</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.2</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_node_label</span><span class='op'>(</span>
      <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>splitvar</span><span class='op'>)</span>,
      ids <span class='op'>=</span> <span class='st'>"inner"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_node_plot</span><span class='op'>(</span>
      gglist <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
        <span class='fu'>geom_boxplot</span><span class='op'>(</span>
          <span class='fu'>aes</span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>outcome</span><span class='op'>)</span>, 
          size <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,
        <span class='fu'>theme_minimal</span><span class='op'>(</span>base_size <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span>,
        <span class='fu'>theme</span><span class='op'>(</span>
          axis.title.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
          axis.text.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
          axis.line.y <span class='op'>=</span> <span class='fu'>element_line</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span>,
          panel.grid.minor.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>
          <span class='op'>)</span><span class='op'>)</span>,
      shared_axis_labels <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_node_label</span><span class='op'>(</span>
    line_list <span class='op'>=</span> 
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
        <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>splitvar</span><span class='op'>)</span>,
        <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'N = '</span> , <span class='va'>nodesize</span><span class='op'>)</span><span class='op'>)</span>,
        <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'>significance_level</span><span class='op'>(</span><span class='va'>p.value</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
    line_gpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>80</span><span class='op'>)</span>,
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>,
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>,
    ids <span class='op'>=</span> <span class='st'>"inner"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_node_label</span><span class='op'>(</span>
    <span class='fu'>aes</span><span class='op'>(</span>
      label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"N = "</span>, <span class='va'>nodesize</span><span class='op'>)</span>
      <span class='op'>)</span>,
    ids <span class='op'>=</span> <span class='st'>"terminal"</span>, 
    line_gpar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>
    <span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="apa-2021_files/figure-html5/plot%20tree%201-1.png" width="6144" /></p>
</div>
<p>There are two ways we could begin working to make results which can be interpreted.</p>
<h3 id="add-hyperparameters">Add hyperparameters</h3>
<p>Hyperparameters are parameters that can be specified by the researcher; these parameters influence the estimation of the parameters in the model. These are common for machine learning, and those relevant to GLMM trees are any that are relevant to decision trees or parameter instability tests (see <a href="https://cran.r-project.org/web/packages/partykit/partykit.pdf"><code>{partykit}</code></a>).</p>
<p>I’ll point you towards a few and their defaults.</p>
<ul>
<li><code>bonferroni = TRUE</code>: Bonferroni corrects <em>p</em>-values. Recommended to leave on.</li>
<li><code>alpha = 0.05</code>: <em>p</em>-value indicated significant parameter stability. This is typically the first parameter I change, making the threshold more stringent (e.g., <code>alpha = 0.001</code>).</li>
<li><code>minsize = NULL</code>: the minimum cases allowed in the terminal node. The larger you make this, the more of the sample has to be in a node for you to trust there is generalize-able heterogeneity and not just noise in your data (e.g., <code>minsize = 0.10*nrow(your_data_set)</code>)</li>
<li><code>trim = NULL</code>: this specifies the percentage (if &lt; 0) or number (if &gt; 0) of outliers to be be omitted from the parameter instability tests. This is done to prevent undue influence of outliers, and does not influence group assignment/splitting; it is just used in testing.</li>
<li><code>maxdepth = Inf</code>: the depth of the tree that’s allowed to grow. This functionally decreases the level of interactions you allow the data to find.</li>
</ul>
<p>These should be tuned carefully and resulting models are ideally discussed with content experts and compared to prior research for validity.</p>
<p>Let’s re-run this with some more stringent hyperparameters and see if <code>x</code> and <code>z</code> are still contributing:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_2</span> <span class='op'>&lt;-</span> 
  <span class='fu'>lmertree</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_dat</span>, 
    formula <span class='op'>=</span> 
      <span class='va'>outcome</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>|</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>z</span> <span class='op'>+</span> <span class='va'>w</span>, 
    cluster <span class='op'>=</span> <span class='va'>id</span>, 
    alpha <span class='op'>=</span> <span class='fl'>0.001</span>, 
    minsize <span class='op'>=</span> <span class='fl'>0.15</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>sim_dat</span><span class='op'>)</span>, 
    trim <span class='op'>=</span> <span class='fl'>0.1</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>tree_2</span>, which <span class='op'>=</span> <span class='st'>'tree'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="apa-2021_files/figure-html5/plot%20tree%202-1.png" width="768" /></p>
</div>
<p>These groups do not seem too small to interpret the effects, but we in a world so comfortable with inferential statistics, we could estimate fixed effects for these variables and see if we can still find subgroup effects.</p>
<h3 id="add-fixed-effects">Add Fixed Effects</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_3</span> <span class='op'>&lt;-</span> 
  <span class='fu'>lmertree</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_dat</span>, 
    formula <span class='op'>=</span> 
      <span class='va'>outcome</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>|</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>w</span> <span class='op'>+</span> <span class='va'>z</span> <span class='op'>+</span> <span class='va'>x</span>, 
    cluster <span class='op'>=</span> <span class='va'>id</span>, 
    alpha <span class='op'>=</span> <span class='fl'>0.001</span>, 
    minsize <span class='op'>=</span> <span class='fl'>0.15</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>sim_dat</span><span class='op'>)</span>, 
    trim <span class='op'>=</span> <span class='fl'>0.1</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>tree_3</span>, which <span class='op'>=</span> <span class='st'>'tree'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="apa-2021_files/figure-html5/plot%20tree%203-1.png" width="768" /></p>
</div>
<p>This figure suggests the association of <code>x</code> varies by level of <code>z</code>, such that higher levels of <code>z</code> correspond to greater average levels of <code>outcome</code> and greater associations between <code>x</code> and <code>outcome</code> (i.e., higher intercepts and slopes).</p>
<p>In other words, when <code>z</code> increases, both <code>outcome</code> increases and the influence of <code>x</code> on <code>outcome</code> increases.</p>
<p>Of course, you could then add the fixed effect of z, to control for it’s influence.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_4</span> <span class='op'>&lt;-</span> 
  <span class='fu'>lmertree</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_dat</span>, 
    formula <span class='op'>=</span> 
      <span class='va'>outcome</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>+</span> <span class='va'>z</span> <span class='op'>|</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>w</span> <span class='op'>+</span> <span class='va'>z</span> <span class='op'>+</span> <span class='va'>x</span>, 
    cluster <span class='op'>=</span> <span class='va'>id</span>, 
    alpha <span class='op'>=</span> <span class='fl'>0.001</span>, 
    minsize <span class='op'>=</span> <span class='fl'>0.15</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>sim_dat</span><span class='op'>)</span>, 
    trim <span class='op'>=</span> <span class='fl'>0.1</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>tree_4</span>, which <span class='op'>=</span> <span class='st'>'tree'</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="apa-2021_files/figure-html5/plot%20tree%204-1.png" width="768" /></p>
</div>
<p>You see, even controlling for level of <code>z</code>, the interaction is observed here. the relation of <code>z</code> to <code>outcome</code> is fairly constant.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>tree_4</span><span class='op'>$</span><span class='va'>tree</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>$`3`

Call:
lm(formula = outcome ~ x + z, offset = .ranef)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.3404 -1.2599  0.0785  1.2732  4.7351 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   4.6483     0.5171   8.989 4.10e-16 ***
x            -0.3152     0.1677  -1.880   0.0618 .  
z             2.2098     0.3268   6.763 1.98e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.928 on 174 degrees of freedom
Multiple R-squared:  0.3212,    Adjusted R-squared:  0.3134 
F-statistic: 41.17 on 2 and 174 DF,  p-value: 2.299e-15


$`4`

Call:
lm(formula = outcome ~ x + z, offset = .ranef)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.5024 -1.4009 -0.0512  1.3477  6.3827 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.41059    0.10961  40.239  &lt; 2e-16 ***
x            0.86367    0.09952   8.678  &lt; 2e-16 ***
z            1.93628    0.23708   8.167 2.33e-15 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.129 on 529 degrees of freedom
Multiple R-squared:  0.271, Adjusted R-squared:  0.2682 
F-statistic: 98.31 on 2 and 529 DF,  p-value: &lt; 2.2e-16


$`5`

Call:
lm(formula = outcome ~ x + z, offset = .ranef)

Residuals:
   Min     1Q Median     3Q    Max 
-5.518 -1.488  0.064  1.462  6.366 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   4.3452     0.2463  17.642   &lt;2e-16 ***
x             2.0237     0.1094  18.493   &lt;2e-16 ***
z             1.9798     0.2070   9.563   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.073 on 353 degrees of freedom
Multiple R-squared:  0.5984,    Adjusted R-squared:  0.5962 
F-statistic:   263 on 2 and 353 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tree_5</span> <span class='op'>&lt;-</span> 
  <span class='fu'>lmertree</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_dat</span>, 
    formula <span class='op'>=</span> 
      <span class='va'>outcome</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>*</span> <span class='va'>z</span> <span class='op'>|</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span> <span class='op'>|</span> <span class='va'>w</span> <span class='op'>+</span> <span class='va'>z</span>, 
    cluster <span class='op'>=</span> <span class='va'>id</span>, 
    alpha <span class='op'>=</span> <span class='fl'>0.001</span>, 
    minsize <span class='op'>=</span> <span class='fl'>0.15</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>sim_dat</span><span class='op'>)</span>, 
    trim <span class='op'>=</span> <span class='fl'>0.1</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
</div>
<h1 id="mlms-via-lme4">MLMs via <code>{lme4}</code></h1>
<p>If we run a traditional multilevel model (MLM) on this data, we see how closely the MLM estimates identify the simulated effects. We can see the nuisance variable <code>w</code> correctly does not have significant associations with the outcome</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>confirmation_lmer</span> <span class='op'>&lt;-</span> 
  <span class='fu'>lmer</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_dat</span>, 
    formula <span class='op'>=</span> <span class='va'>outcome</span> <span class='op'>~</span> <span class='va'>x</span> <span class='op'>*</span> <span class='va'>z</span> <span class='op'>+</span> <span class='va'>w</span> <span class='op'>+</span>
      <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>id</span><span class='op'>)</span>
  <span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>confirmation_lmer</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: outcome ~ x * z + w + (1 | id)
   Data: sim_dat

REML criterion at convergence: 4729.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4943 -0.6663 -0.0260  0.6799  2.9690 

Random effects:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 0.7374   0.8587  
 Residual             4.5271   2.1277  
Number of obs: 1065, groups:  id, 71

Fixed effects:
            Estimate Std. Error t value
(Intercept)  4.37559    0.12117  36.111
x            1.09797    0.07135  15.389
z            1.95442    0.06737  29.011
w            0.06962    0.06750   1.031
x:z          0.80677    0.07160  11.268

Correlation of Fixed Effects:
    (Intr) x      z      w     
x   -0.053                     
z    0.012 -0.014              
w    0.013 -0.024 -0.027       
x:z -0.005 -0.049 -0.141 -0.003</code></pre>
</div>
<h1 id="references-recommended-reading">References &amp; Recommended Reading</h1>
<p>Fokkema, M., Edbrooke-Childs, J., &amp; Wolpert, M. (2020). Generalized linear mixed-model (GLMM) trees: A flexible decision-tree method for multilevel and longitudinal data. Psychotherapy Research, 31(3), 329-341.</p>
<p>Fokkema, M., Smits, N., Zeileis, A., Hothorn, T., &amp; Kelderman, H. (2018). Detecting treatment-subgroup interactions in clustered data with generalized linear mixed-effects model trees. Behavior research methods, 50(5), 2016-2034.</p>
<p>Hothorn, T. &amp; Zeileis, A. (2015). partykit: A Modular Toolkit for Recursive Partytioning in R. Journal of Machine Learning Research, 16, 3905-3909.</p>
<p>Hothorn, T., Hornik, K., &amp; Zeileis, A. (2006). Unbiased recursive partitioning: A conditional inference framework. Journal of Computational and Graphical statistics, 15(3), 651-674.</p>
<p>Hulleman, C. S., Godes, O., Hendricks, B. L., &amp; Harackiewicz, J. M. (2010). Enhancing interest and performance with a utility value intervention. Journal of educational psychology, 102(4), 880.</p>
<p>Borkovec, M. &amp; Madin, N. (2019). ggparty: ‘ggplot’ Visualizations for the ‘partykit’ Package. R package version 1.0.0.</p>
<p>Villanueva, I., Husman, J., Christensen, D., Youmans, K., Khan, M.T., Vicioso, P., Lampkins, S. and Graham, M.C., 2019. A Cross-Disciplinary and Multi-Modal Experimental Design for Studying Near-Real-Time Authentic Examination Experiences. JoVE (Journal of Visualized Experiments), (151), p.e60037.</p>
<p>Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software, 4(43), 1686,</p>
<p>Zeileis, A. (2001). strucchange: Testing for structural change in linear regression relationships. R News, 1(3), 8-11.</p>
<p>Zeileis, A., Hothorn, T., &amp; Hornik, K. (2008). Model-based recursive partitioning. Journal of Computational and Graphical Statistics, 17(2), 492-514.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
